<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Yu Xia" />

<meta name="date" content="2020-01-02" />

<title>Introduction to SC19099</title>

<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to SC19099</h1>
<h4 class="author">Yu Xia</h4>
<h4 class="date">2020-01-02</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p><strong>SC19099</strong> is a simple R package developed to implement two functions. Two functions are <em>Gram</em> (generate a matrix consisting of the inner product of vectors) and <em>edgemat</em> (establish a relationship matrix between variables with a set probability) respectively. Specifically, by inputting a set of vectors, the internal product between the vectors can be calculated using <em>Gram</em>, and these internal products form a symmetric matrix; By entering the set probability and the dimension of the variable, the probability can be used to determine whether the variables are related by <em>edgemat</em>, If relevant, matrix corresponding element is 1, otherwise 0.</p>
<p>The source R code for <em>Gram</em> is as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="cf">function</span>(m){</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(m)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">  G &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> n,<span class="dt">ncol =</span> n)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">      G[i,j] &lt;-<span class="st"> </span>m[i,] <span class="op">%*%</span><span class="st"> </span>m[j,] </a>
<a class="sourceLine" id="cb1-7" data-line-number="7">    }</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  }</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">  <span class="kw">return</span>(G)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">}</a></code></pre></div>
<p>The input variable m is a set of vectors, and we want to compute their inner products. To present its usage,the example is as follows. state.x77 is a data set containing eight indicators from fifty states in the United States. By using <em>Gram</em>, we get the inner product matrix of 50 * 50.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(SC19099)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">data</span>(data)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">g &lt;-<span class="st"> </span><span class="kw">Gram</span>(state.x77)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw">print</span>(g)</a></code></pre></div>
<p>The source R code for <em>edgemat</em> is as follows:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="cf">function</span>(p,pr){</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow =</span> p,<span class="dt">ncol =</span> p) </a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(p<span class="dv">-1</span>)) {</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">    <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>p) {</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">      prob &lt;-<span class="st"> </span>pr[i,j]</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">      lineornot &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">1</span>,<span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>prob,prob))</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">      <span class="cf">if</span>(lineornot <span class="op">==</span><span class="st"> </span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">        mat[i,j] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">      }</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">    }</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">  }</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">  mat[<span class="kw">lower.tri</span>(mat)] &lt;-<span class="st"> </span><span class="kw">t</span>(mat)[<span class="kw">lower.tri</span>(mat)]</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">}</a></code></pre></div>
<p>The input variable p is the dimension of variable, and pr is the probability matrix that determines the relationship between corresponding variables. To present its usage,the example is as follows. First 100 points are generated, evenly distributed in [0,1] * [0,1]. Then the probability that the two points are related is ψ(d * √p), where d is the Euclidean distance between the pair of variables and ψ is the density of the standard normal distribution.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">library</span>(SC19099)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">p &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">x &lt;-<span class="st"> </span><span class="kw">runif</span>(p,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">y &lt;-<span class="st"> </span><span class="kw">runif</span>(p,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">node &lt;-<span class="st"> </span><span class="kw">cbind</span>(x,y)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">distance &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">dist</span>(node))</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">pr &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow =</span> p,<span class="dt">ncol =</span> p)</a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(p<span class="dv">-1</span>)) {</a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="cf">for</span> (j <span class="cf">in</span> (i<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>p) {</a>
<a class="sourceLine" id="cb4-10" data-line-number="10"> d &lt;-<span class="st"> </span>distance[i,j]</a>
<a class="sourceLine" id="cb4-11" data-line-number="11"> pr[i,j] &lt;-<span class="st"> </span><span class="kw">dnorm</span>(d <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(p))</a>
<a class="sourceLine" id="cb4-12" data-line-number="12"> }}</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">e &lt;-<span class="st"> </span><span class="kw">edgemat</span>(p,pr)</a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="kw">print</span>(e)</a></code></pre></div>
</div>
<div id="homework" class="section level2">
<h2>Homework</h2>
<div id="hw1" class="section level3">
<h3>HW1</h3>
</div>
<div id="question" class="section level3">
<h3>Question</h3>
<blockquote>
<p>Use knitr to produce at least 3 examples (texts,figures,tables).</p>
</blockquote>
</div>
<div id="answer" class="section level3">
<h3>Answer</h3>
</div>
<div id="text" class="section level3">
<h3>Text</h3>
<p>It’s really my honor to have the opportunity to study statistical computing.At college,I spent most time to learn from textbooks.Therefore,though I have knowledge of many theories,I just don’t know how to put into practice.I believe the lesson will bring me some fresh experience. Thanks all of you(my teacher,TA and classmates) for the following company.</p>
</div>
<div id="table" class="section level3">
<h3>Table</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(airquality))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Ozone</th>
<th align="right">Solar.R</th>
<th align="right">Wind</th>
<th align="right">Temp</th>
<th align="right">Month</th>
<th align="right">Day</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">41</td>
<td align="right">190</td>
<td align="right">7.4</td>
<td align="right">67</td>
<td align="right">5</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">36</td>
<td align="right">118</td>
<td align="right">8.0</td>
<td align="right">72</td>
<td align="right">5</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">149</td>
<td align="right">12.6</td>
<td align="right">74</td>
<td align="right">5</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">313</td>
<td align="right">11.5</td>
<td align="right">62</td>
<td align="right">5</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">14.3</td>
<td align="right">56</td>
<td align="right">5</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">28</td>
<td align="right">NA</td>
<td align="right">14.9</td>
<td align="right">66</td>
<td align="right">5</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
</div>
<div id="figure" class="section level3">
<h3>Figure</h3>
<p>Use the data of heights and weights of the males to analyse their relationship.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">height &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">165</span>,<span class="dv">168</span>,<span class="dv">170</span>,<span class="dv">172</span>,<span class="dv">175</span>,<span class="dv">178</span>,<span class="dv">180</span>,<span class="dv">182</span>,<span class="dv">183</span>,<span class="dv">185</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">weight &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">60</span>,<span class="dv">55</span>,<span class="dv">64</span>,<span class="dv">65</span>,<span class="dv">70</span>,<span class="dv">70</span>,<span class="dv">71</span>,<span class="dv">75</span>,<span class="dv">80</span>,<span class="dv">78</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">lm.hw &lt;-<span class="st"> </span><span class="kw">lm</span>(weight<span class="op">~</span>height)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="kw">plot</span>(lm.hw)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="hw2" class="section level3">
<h3>HW2</h3>
</div>
<div id="question-1" class="section level3">
<h3>Question 1</h3>
<blockquote>
<p>The Rayleigh density [156, Ch. 18] is f(x) = x/σ2*exp(−x2/(2σ2)), x ≥ 0,σ &gt; 0. Develop an algorithm to generate random samples from a Rayleigh(σ) distribution. Generate Rayleigh(σ) samples for several choices of σ &gt; 0 and check that the mode of the generated samples is close to the theoretical mode σ(check the histogram).</p>
</blockquote>
</div>
<div id="answer-1" class="section level3">
<h3>Answer 1</h3>
<div id="建立生成n个来自rayleighsigma的随机数的函数" class="section level5">
<h5>建立生成n个来自Rayleigh(sigma)的随机数的函数：</h5>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">rayleigh &lt;-<span class="st"> </span><span class="cf">function</span>(n,sigma){</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"> u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"> x &lt;-<span class="st"> </span>(<span class="op">-</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>sigma <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u)) <span class="op">^</span><span class="st"> </span><span class="fl">0.5</span> <span class="co">#F(x)=1-exp(-x^2/2/sigma^2),x&gt;=0</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"> <span class="kw">return</span>(x)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">}</a></code></pre></div>
</div>
<div id="生成3组sigma分别为158的随机数" class="section level5">
<h5>生成3组sigma分别为1,5,8的随机数:</h5>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">r_sam1 &lt;-<span class="st"> </span><span class="kw">rayleigh</span>(<span class="dv">1000</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">r_sam2 &lt;-<span class="st"> </span><span class="kw">rayleigh</span>(<span class="dv">1000</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">r_sam3 &lt;-<span class="st"> </span><span class="kw">rayleigh</span>(<span class="dv">1000</span>,<span class="dv">8</span>)</a></code></pre></div>
</div>
<div id="绘制随机数的频率直方图与理论分布作比较" class="section level5">
<h5>绘制随机数的频率直方图与理论分布作比较:</h5>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">hist</span>(<span class="kw">rayleigh</span>(<span class="dv">1000</span>,<span class="dv">1</span>),<span class="dt">prob =</span> <span class="ot">TRUE</span>,,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">~</span><span class="er">~~</span>sigma<span class="op">==</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">sigma &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="kw">lines</span>(y,y<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">hist</span>(<span class="kw">rayleigh</span>(<span class="dv">1000</span>,<span class="dv">5</span>),<span class="dt">prob =</span> <span class="ot">TRUE</span>,,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">~</span><span class="er">~~</span>sigma<span class="op">==</span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">sigma &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="kw">lines</span>(y,y<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">hist</span>(<span class="kw">rayleigh</span>(<span class="dv">1000</span>,<span class="dv">8</span>),<span class="dt">prob =</span> <span class="ot">TRUE</span>,,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">~</span><span class="er">~~</span>sigma<span class="op">==</span><span class="dv">8</span>))</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">sigma &lt;-<span class="st"> </span><span class="dv">8</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="kw">lines</span>(y,y<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-2" class="section level3">
<h3>Question 2</h3>
<blockquote>
<p>Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have N(0, 1) and N(3, 1) distributions with mixing probabilities p1 and p2 = 1 − p1. Graph the histogram of the sample with density superimposed, for p1 = 0.75. Repeat with different values for p1 and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of p1 that produce bimodal mixtures.</p>
</blockquote>
</div>
<div id="answer-2" class="section level3">
<h3>Answer 2</h3>
<div id="建立生成n个来自mixture的随机数的函数" class="section level5">
<h5>建立生成n个来自Mixture的随机数的函数：</h5>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">Mix &lt;-<span class="st"> </span><span class="cf">function</span>(n,p){</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">X1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">X2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">r &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p,p))</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">M &lt;-<span class="st"> </span>r<span class="op">*</span>X1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r)<span class="op">*</span>X2</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="kw">return</span>(M)</a>
<a class="sourceLine" id="cb12-7" data-line-number="7">}</a></code></pre></div>
</div>
<div id="生成三组p分别为0.750.250.5的混合随机数" class="section level5">
<h5>生成三组p分别为0.75,0.25,0.5的混合随机数：</h5>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">M1 &lt;-<span class="st"> </span><span class="kw">Mix</span>(<span class="dv">1000</span>,<span class="fl">0.75</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw">hist</span>(M1,<span class="dt">main =</span> <span class="kw">expression</span>(p<span class="op">==</span><span class="fl">0.75</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">M2 &lt;-<span class="st"> </span><span class="kw">Mix</span>(<span class="dv">1000</span>,<span class="fl">0.25</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw">hist</span>(M2,<span class="dt">main =</span> <span class="kw">expression</span>(p<span class="op">==</span><span class="fl">0.25</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAY1BMVEUAAAAAADoAAGYAOpAAZmYAZrY6AAA6ADo6AGY6OgA6kNtmAABmADpmAGZmZgBmkJBmtrZmtv+QOgCQOjqQZgCQ2/+2ZgC2/7a2/9u2///bkDrb////tmb/25D//7b//9v////Egw5OAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKtklEQVR4nO2dcWPbJhDFX5Ml6+quW71VaxXZzvf/lJNAllMMHPg43aXW758FC9693hDCEkZ43cgCbQPWgbYB60DbgHWgbcA60DZgHWgbsA60DVgH2gasA20D1oG2AetA24B1oG3AOtA2YB1oG7AOtA1YB9oGrANtA9aBtgHrQNuAdaBtwDrQNmAdaBuwDrQNWAfaBqwDbQPWgbYB60DbgHWgbcA60DZgHWgbsA60DVCc9gC+XsrH3Vh+fJn+7OH4mmraBIiq83H5eZOEw7Mrf/g2/t1tCZp6ydhbBjz88MXT3qVmwNP0t+9IskA+BIfT3qWmP3eT4+5p+Xj+WxisEIOge/gxniznPvIzx53rJQM+/fSx6zyH50+xJo3BCjEIuocvy7AScnh+evOfBXeKDfh7dx6v5YCsfAmdy02H2Akz95LgbDrupv42X8SiiW0HRNWL6Nw/cR5tzpcmYO46kQQdd/NF7OvrdedqDUTVi+h8ZvpYV4idYofnn2p28dGrFZAULyOXoMgg3Qfj+R0kKHOKhZf5eWI0MedOejYESfEyOtcl4oN0OFEcy0+XdlPWwhlAayCqXkT34Y+px8TPlDdfNaZz0H0Tm2vPfwtf5yGqXkT38H2f/ndevqxOCRpwSZA/JD2bhrB+AcKjLBNoG9gSRLIliGBL0LsG2gasA20D1oG2AetA24B1oG3AOtA2YB1oG7AOtA1YB9oGrANtA9aBtgHrQNuAdaBtwDrQNmAdaBuwDrQNWAfaBqwDbQPWgbYB60DbgHWgbcA60DZgHWgbsA60DVgH2gasA20D1kFV7Xk5U2Kx0y8Jair35+Vu0uveDIGKuqf9kpZ+jd+RmAAVdY+7Za3pcDcnGSrqbj2IYlmuvI1BCc6rcFX7D0Jko4mqiwCiLBvtHQCiLBstx3E3jTyD9kQRRFk2Wg6XIHf9enPBXx8QZdloOaYEzanRvMyDKMtGyzEl6PDsEhRMFFe6oszBiLJstBwFPahG7lbCGLIxa9T9LOjp9TxcM+VuJYwhG7NSfcyR+1FSaiJdKXcTYQzZmI3VG8sVxZCN2Vi9sdwsmv9qIRLzRvV++fVfYqpYJ1cIskVLCfK/Gp1G6S1BMfz9IPc77DtM0Hh9on4fe/6C0T2+3GGC/ACTvQ+23FHsnu4yQa9kjs5pGXvbnSbIpyh9M+N8z/W8jwQp1wRki2smaHBXcc5uGCBr8EXDGCIxI+rHZTsnxjMdkDX4omEMkZjX6vOuRa3kWoJs0dA8aH25qGgYQyRmTL1zG9HwHniBrMEXDWOIxIyod24AYm5OCLIGXzSMIRLzWv08TeY9dQdZgy8axhCJea1+nian5sh5FdF70sgWVzvF+nnXPdYgBLIGXzSMIRIzpu422mVe60HW4IuGMURiSqk3louKhjFEYkqpN5aLioYxRGJG1Jss0ARZgy8axhCJGVFvshEUyBp80TCGSMxr9eSzwNvkWoJsce2JYiO5liBbXG+i2GLLRpA1+KJhDJGYEfWhxesFQNbgi4YxRGJeq7/dJbWBXEuQLW7zoC1BlaJhDJGYMfXxJHt86bYbZin14cO3/vGFOR0CWYMvGsYQiXmtPt0P6jNP3SvlWoJscc2J4pSg7Y5iQv3cgzrWAl+QNfiiYQyRmBF1Pwb1N00X7+KWq58qbncUZdUby0VFwxgiMaXUG8tFRcMYIjGv1bfvYkXBub/WDeWagGxx7VOs2x4959W3iSKhnv2qQT75uJJrAbLFlROUXd1Bb00RyjUB2eLaV7HMN42CjQUQ/bTWU/7HGWGMJjHTZirqFmxNUSOXJBRB1eHG1Kiv1oPyZeJwYxb1ZaKYGYPprSkQ/5jwUPd7J+JwYy7q/rFP/ts8OVAh8Xmhh6IyVb0ti/pp7zPD+8E3yBoFjYgyVb0ti/rxs7/RoTBRDBsRZap6Wxb1cw/K3lGUmSiGjYgyVb0tF/XB3SuLvg72jNBEMWxElK8OE2M8jzdqbgTO9x+Zy3zYiChXVmdSo5aeKPL+74WNiHJldSY1avfeg+hHz1ITxbpyZXUmF7WSR8+NJop1M2cjCVrz0TOyRaMJWvPRM7JFowla89EzskWjCWI9eo7IVdQKGxHlyupM3qiRj54L7oiUmUO2aDZBNMmfy1fKIVs0mqA3s8A05GJq5A/Ha4WNiHJldSaLWtlKe2oxNbJHE7XCRkS5sjqTi1qTLaJB1ojUChsR5crqTBa1NRcvIFs0mqA15ZAtbgl6hwlqtnktbqkVNiLKldWZeDWXoKILfZFcZa2wEVGurM7Eq20JSuLVuAmqvOWKbPFXTFAgV1krbESUK6sz8WpbgpJ4tS1BSbxaydKOCrnKWmEjolxZnUlbtS1Bt8kx19TxqjNpq5ZKUL5MHN4SRBzeEkQc3hJEHN4SRByurt50uRCzeZlc+CmqDjeuXgmzeZlc+CmqDm8JIg5vCSIOv6cE3bjKNfwUVYffUYJuXeUafoqqw+8nQcVrFKmFucgW32+Cile5XiXIFHIJ2t7US7G9qZfCxJt61wXaBqyDVYKowvTeIgHMIJQHXnNKnRe8DUQQygOvOaXOC94GIgjlgdecUucFbwMRhPLAa06p84K3gQhCeeA1p9R5wdtABKE88JpT6rzgbSCCUB54zSl1XvA2EEEoD7zmlDoveBuIIJQHXnNKnRd8A9oGrANtA9aBtgHrQNuAdaBtwDrQNmAdaBuwDrQNWAfaBqwDbQPWgbYB60DbgHWwQgy3aCb1KHbI7/aQbevJ7TYyvRqV9940sFoXcdqPGegTPqet5YZ0hrJtZ4XMc95hPGTx7dU/c3h2W3xGF1359RDpXdBzbT1u36zEMa9u8GU8MeLdhE5Auq2nf/w3maDD77y3hEyArVBI/C2l/p9AbfqQecPpKJAeg4aH/3bUCEYBVutyEgtmfN/I9ZB024npJEonqJ8WUzLfbglO43KGzBhNJSjVdiK/Z5bfVtTgawyuSPaBglMst1jLNc8kyOn6ce5WwGhL0/tJTJ/8N9KDdLrtrD+RyIBPPG+oBqNtKZl90ajLPLEBuCPdg/yqU/On2OE50weIiWK27UxmJj0NUcwfc4PTuIz5PEhkoc9+1ci39eS+agzkFxUKsFrfAdA2YB1oG7AOtA1YB9oGrANtA9aBtgHrQNuAdaBtwDrQNmAdaBuwDrQNWAfaBqwDbQPWgbYB60DbgHWgbcA60DZgHWgbsA60DVgH2gasA20D1oG2AetA24B1oG3AOtA2YB1oG7AOtA2kOO3nh+puFWvBamAhoBG0hDElflFCN/63YDWwFFCIWcRp/5t7wfvxzy+PL2WLYUXA+iHLOO2f3FuDh8syX2KtpwxYP2QZY4KmdfKv3adl/U9mNbAcWD9kGWOCDh9/vB4/L+ugdbbeg0LMIsYEnfZfp19bzAnKrQYWBBpBS5jWf/dP4xk2L7HT2roRKlELmBJ0+Pj9n28+QdnVwJJAJyzNlKDT/q9xGJoSxHzDMgMoxSVxP7HopnGnm+ZBalujQiswhUuQe+9tN72im14NLATWD/m+gLYB60DbgHWgbcA60DZgHWgbsA60DVgH2gasA20D1oG2AetA24B1oG3AOtA2YB1oG7AOtA1YB9oGrANtA9aBtgHrQNuAdaBtwDrQNmAdaBuwDrQNWAfaBqzzP7kahuz7aSP3AAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">M3 &lt;-<span class="st"> </span><span class="kw">Mix</span>(<span class="dv">1000</span>,<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw">hist</span>(M3,<span class="dt">main =</span> <span class="kw">expression</span>(p<span class="op">==</span><span class="fl">0.5</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="通过以上尝试可以得出p0.75时分布呈右偏单峰p0.25时分布呈左偏单峰p0.5时分布呈双峰形态" class="section level5">
<h5>通过以上尝试,可以得出p=0.75时分布呈右偏单峰,p=0.25时分布呈左偏单峰,p=0.5时分布呈双峰形态。</h5>
</div>
</div>
<div id="question-3" class="section level3">
<h3>Question 3</h3>
<blockquote>
<p>Write a function to generate a random sample from a Wd(Σ, n) (Wishart) distribution for n&gt;d + 1≥1, based on Bartlett’s decomposition.</p>
</blockquote>
</div>
<div id="answer-3" class="section level3">
<h3>Answer 3</h3>
<div id="建立生成wishart分布随机样本的函数" class="section level5">
<h5>建立生成Wishart分布随机样本的函数:</h5>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">W_sam &lt;-<span class="st"> </span><span class="cf">function</span>(sigma,n){</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">  p &lt;-<span class="st"> </span><span class="kw">nrow</span>(sigma)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">  L &lt;-<span class="st"> </span><span class="kw">chol</span>(sigma) <span class="co">#对sigma进行Cholesky分解</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4">  A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> p,<span class="dt">ncol =</span> p) <span class="co">#生成p*p的空矩阵</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5">  A[<span class="kw">upper.tri</span>(A)] &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co">#将上三角用0填满</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6">  c &lt;-<span class="st"> </span><span class="kw">numeric</span>(p)</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>p) {</a>
<a class="sourceLine" id="cb16-8" data-line-number="8">    c[i] &lt;-<span class="st"> </span><span class="kw">rchisq</span>(<span class="dv">1</span>,n <span class="op">-</span><span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) </a>
<a class="sourceLine" id="cb16-9" data-line-number="9">  }</a>
<a class="sourceLine" id="cb16-10" data-line-number="10">  <span class="kw">diag</span>(A) &lt;-<span class="st"> </span>c <span class="co">#用卡方分布随机数填满对角线</span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11">  A[<span class="kw">lower.tri</span>(A)] &lt;-<span class="st"> </span><span class="kw">rnorm</span>((p <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>p) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>) <span class="co">#用标准正态随机数填满下三角</span></a>
<a class="sourceLine" id="cb16-12" data-line-number="12">  S &lt;-<span class="st"> </span>L<span class="op">%*%</span>A<span class="op">%*%</span><span class="kw">t</span>(A)<span class="op">%*%</span><span class="kw">t</span>(L) <span class="co">#Bartlett分解</span></a>
<a class="sourceLine" id="cb16-13" data-line-number="13">  <span class="kw">return</span>(S)</a>
<a class="sourceLine" id="cb16-14" data-line-number="14">}</a></code></pre></div>
</div>
<div id="生成一个wishart分布的随机样本" class="section level5">
<h5>生成一个Wishart分布的随机样本:</h5>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">sigma &lt;-<span class="st"> </span><span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="kw">diag</span>(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="kw">W_sam</span>(sigma,n)</a></code></pre></div>
<pre><code>##            [,1]      [,2]       [,3]         [,4]        [,5]        [,6]
## [1,]  480.03207  26.44685 -16.700203  48.02482120 72.30607142 -113.702983
## [2,]   26.44685 596.35986  26.456358  14.02143580 48.48666490   46.199587
## [3,]  -16.70020  26.45636 188.529701  21.09292867  4.55083064    8.090671
## [4,]   48.02482  14.02144  21.092929 240.39488376 -0.05635274  -80.830657
## [5,]   72.30607  48.48666   4.550831  -0.05635274 86.05877533   -3.316070
## [6,] -113.70298  46.19959   8.090671 -80.83065719 -3.31606974  120.318434</code></pre>
</div>
</div>
<div id="hw3" class="section level3">
<h3>HW3</h3>
</div>
<div id="question-1-1" class="section level3">
<h3>Question 1</h3>
<blockquote>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\int_{0}^{\pi / 3} \sin t\]</span> and compare your estimate with the exact value of the integral.</p>
</blockquote>
</div>
<div id="answer-1-1" class="section level3">
<h3>Answer 1</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">m &lt;-<span class="st"> </span><span class="fl">1e4</span> <span class="co">#the number of random number</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">x &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span>pi <span class="op">/</span><span class="st"> </span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb19-3" data-line-number="3">theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(pi <span class="op">/</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="kw">sin</span>(x)) <span class="co">#the estimate</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="kw">print</span>(<span class="kw">c</span>(theta.hat,<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)) <span class="co">#compare the estimate with the theoretical value</span></a></code></pre></div>
<pre><code>## [1] 0.4977503 0.5000000</code></pre>
<p>By comparing the results,we can see the estimate is very close to the exact value of the integral.</p>
</div>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<blockquote>
<p>Use Monte Carlo integration with antithetic variables to estimate <span class="math display">\[\int_{0}^{1} \frac{e^{-x}}{1+x^{2}} d x\]</span> and find the approximate reduction in variance as a percentage of the variance without variance reduction.</p>
</blockquote>
</div>
<div id="answer-2-1" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">m &lt;-<span class="st"> </span><span class="fl">1e4</span> </a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-3" data-line-number="3">x &lt;-<span class="st"> </span><span class="kw">runif</span>(m) </a>
<a class="sourceLine" id="cb21-4" data-line-number="4">thetas &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb21-5" data-line-number="5">theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(thetas) <span class="co">#the estimate </span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6">var1 &lt;-<span class="st"> </span><span class="kw">var</span>(thetas) <span class="op">/</span><span class="st"> </span>m <span class="co">#the variance without variance reduction</span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"></a>
<a class="sourceLine" id="cb21-8" data-line-number="8">MC &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb21-9" data-line-number="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>){</a>
<a class="sourceLine" id="cb21-10" data-line-number="10">y &lt;-<span class="st"> </span><span class="kw">runif</span>(m <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb21-11" data-line-number="11">thetas.new &lt;-<span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>y) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>y<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>y)) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>y)<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb21-12" data-line-number="12">MC[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(thetas.new) </a>
<a class="sourceLine" id="cb21-13" data-line-number="13">}</a>
<a class="sourceLine" id="cb21-14" data-line-number="14">theta.hat.new &lt;-<span class="st"> </span><span class="kw">mean</span>(MC) <span class="co">#the estimate using antithetic variables</span></a>
<a class="sourceLine" id="cb21-15" data-line-number="15"><span class="kw">print</span>(theta.hat.new) <span class="co">#the new estimate</span></a></code></pre></div>
<pre><code>## [1] 0.5248016</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">var2 &lt;-<span class="st"> </span><span class="kw">var</span>(MC) <span class="co">#the variance with variance reduction</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="kw">print</span>(<span class="kw">c</span>(var1,var2,(var1<span class="op">-</span>var2) <span class="op">/</span><span class="st"> </span>var1)) <span class="co">#show the approximate reduction </span></a></code></pre></div>
<pre><code>## [1] 6.077993e-06 2.225254e-07 9.633883e-01</code></pre>
<p>By using antithetic variables,we draw a conclusion that the new estimate is 0.5248016,and the variance reduces about 96.34% of the former.</p>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<blockquote>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</blockquote>
</div>
<div id="answer-3-1" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">q &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,.<span class="dv">2</span>,.<span class="dv">4</span>,.<span class="dv">6</span>,.<span class="dv">8</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>){</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">  q[i] &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span>a[i]) <span class="co">#generate the numbers dividing the integral equally</span></a>
<a class="sourceLine" id="cb25-5" data-line-number="5">}</a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="kw">print</span>(q) </a></code></pre></div>
<pre><code>## [1] 0.0000000 0.1351603 0.2914869 0.4768628 0.7046055 1.0000000</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">m &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">theta &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb27-3" data-line-number="3">var &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</a>
<a class="sourceLine" id="cb27-5" data-line-number="5">  <span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb27-6" data-line-number="6">  U &lt;-<span class="st"> </span><span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb27-7" data-line-number="7">  X &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>q[j]) <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span>U<span class="op">/</span><span class="dv">5</span>) <span class="co">#generate the random number of 5*f_3(x),(q[j],q[j+1])</span></a>
<a class="sourceLine" id="cb27-8" data-line-number="8">  thetas &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)) <span class="op">/</span><span class="st"> </span>(<span class="dv">5</span><span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>X<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb27-9" data-line-number="9">  var[j] &lt;-<span class="st"> </span><span class="kw">var</span>(thetas) <span class="op">/</span><span class="st"> </span>m <span class="co">#the variance of the integral estimate of subinterval</span></a>
<a class="sourceLine" id="cb27-10" data-line-number="10">  theta[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(thetas) <span class="co">#the integral of subinterval </span></a>
<a class="sourceLine" id="cb27-11" data-line-number="11">}</a>
<a class="sourceLine" id="cb27-12" data-line-number="12">theta.hat &lt;-<span class="st"> </span><span class="kw">sum</span>(theta) <span class="co">#the esitimate of the intergral</span></a>
<a class="sourceLine" id="cb27-13" data-line-number="13">std &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">sum</span>(var)) <span class="co">#the estimated standard error </span></a>
<a class="sourceLine" id="cb27-14" data-line-number="14"><span class="kw">print</span>(<span class="kw">c</span>(theta.hat,std))</a></code></pre></div>
<pre><code>## [1] 0.524952205 0.000207217</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">std.old &lt;-<span class="st"> </span><span class="fl">0.0970314</span> <span class="co">#from the textbook</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="kw">print</span>((std.old<span class="op">-</span>std) <span class="op">/</span><span class="st"> </span>std.old) <span class="co">#the percentage reduction of the standard error</span></a></code></pre></div>
<pre><code>## [1] 0.9978644</code></pre>
<p>The stratified importance sampling estimate is 0.524952205,and its standard error is 0.000207217. By using stratified importance sampling,we draw a conclusion that the standard error reduces about 99.79% of the standard error in Example 5.10.</p>
<div id="hw4" class="section level3">
<h3>HW4</h3>
</div>
<div id="question-1-2" class="section level3">
<h3>Question 1</h3>
<blockquote>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of χ2(2) data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</blockquote>
</div>
<div id="answer-1-2" class="section level3">
<h3>Answer 1</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="dv">20</span> <span class="co">#the number of sample data </span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2">alpha &lt;-<span class="st"> </span><span class="fl">.05</span> </a>
<a class="sourceLine" id="cb31-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">CL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb31-5" data-line-number="5">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">2</span>) <span class="co">#generate the sample data from χ2(2)</span></a>
<a class="sourceLine" id="cb31-6" data-line-number="6">  LCL &lt;-<span class="st"> </span><span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n) <span class="co">#the lower confidence limit</span></a>
<a class="sourceLine" id="cb31-7" data-line-number="7">  UCL &lt;-<span class="st"> </span><span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n) <span class="co">#the upper confidence limit</span></a>
<a class="sourceLine" id="cb31-8" data-line-number="8">  <span class="kw">c</span>(LCL,UCL)</a>
<a class="sourceLine" id="cb31-9" data-line-number="9">} )</a>
<a class="sourceLine" id="cb31-10" data-line-number="10">fre &lt;-<span class="st"> </span><span class="dv">0</span> </a>
<a class="sourceLine" id="cb31-11" data-line-number="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>) {</a>
<a class="sourceLine" id="cb31-12" data-line-number="12">  <span class="cf">if</span>(CL[<span class="dv">1</span>,i] <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="dv">2</span> <span class="op">&lt;</span><span class="st"> </span>CL[<span class="dv">2</span>,i]) <span class="co">#the theoretical mean of χ2(2) is 2</span></a>
<a class="sourceLine" id="cb31-13" data-line-number="13">    fre &lt;-<span class="st"> </span>fre <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb31-14" data-line-number="14">}</a>
<a class="sourceLine" id="cb31-15" data-line-number="15"><span class="kw">print</span>(CP &lt;-<span class="st"> </span>fre <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>) <span class="co">#the coverage probability of the t-interval</span></a></code></pre></div>
<pre><code>## [1] 0.926</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="co">#compute the coverage probability for variance if random samples come from χ2(2)</span></a>
<a class="sourceLine" id="cb33-2" data-line-number="2">UCL_var &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb33-3" data-line-number="3">y &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb33-4" data-line-number="4">(n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb33-5" data-line-number="5">} )</a>
<a class="sourceLine" id="cb33-6" data-line-number="6"><span class="kw">print</span>(<span class="kw">mean</span>(UCL_var <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>))<span class="co">#the theoretical variance of χ2(2) is 4</span></a></code></pre></div>
<pre><code>## [1] 0.777</code></pre>
<div id="conclusion-1.1by-computingwe-see-the-coverage-probability-estimate-of-mean-is-0.926which-is-slightly-lower-than-0.95." class="section level5">
<h5><strong>Conclusion 1.1:</strong>By computing,we see the coverage probability estimate of mean is 0.926,which is slightly lower than 0.95.</h5>
</div>
<div id="conclusion-1.2if-random-samples-in-example-6.4-is-from-χ22-the-coverage-probability-estimate-of-variance-is-0.777which-is-far-from-0.95so-the-t-interval-is-more-robust-to-departures-from-normality-than-the-interval-for-variance." class="section level5">
<h5><strong>Conclusion 1.2:</strong>If random samples in Example 6.4 is from χ2(2), the coverage probability estimate of variance is 0.777,which is far from 0.95,so the t-interval is more robust to departures from normality than the interval for variance.</h5>
</div>
</div>
<div id="question-2-2" class="section level3">
<h3>Question 2</h3>
<blockquote>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness √b1 under normality by a Monte Carlo experiment. Compute the standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula). Compare the estimated quantiles with the quantiles of the large sample approximation √b1 ≈ N(0, 6/n).</p>
</blockquote>
</div>
<div id="answer-2-2" class="section level3">
<h3>Answer 2</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw">library</span>(moments) <span class="co">#use the package to compute the sample skewness</span></a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb35-3" data-line-number="3">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb35-4" data-line-number="4">sk &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>,<span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb35-5" data-line-number="5">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb35-6" data-line-number="6">  <span class="kw">skewness</span>(x)</a>
<a class="sourceLine" id="cb35-7" data-line-number="7">})</a>
<a class="sourceLine" id="cb35-8" data-line-number="8">q &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)</a>
<a class="sourceLine" id="cb35-9" data-line-number="9">quantiles &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">quantile</span>(sk,q[<span class="dv">1</span>]),<span class="kw">quantile</span>(sk,q[<span class="dv">2</span>]),<span class="kw">quantile</span>(sk,q[<span class="dv">3</span>]),<span class="kw">quantile</span>(sk,q[<span class="dv">4</span>])) </a>
<a class="sourceLine" id="cb35-10" data-line-number="10"><span class="co"># estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness</span></a>
<a class="sourceLine" id="cb35-11" data-line-number="11"><span class="kw">print</span>(quantiles)</a></code></pre></div>
<pre><code>##       2.5%         5%        95%      97.5% 
## -0.1541258 -0.1291452  0.1211884  0.1472121</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">mean_sk &lt;-<span class="st"> </span><span class="kw">mean</span>(sk)</a>
<a class="sourceLine" id="cb37-2" data-line-number="2">sd_sk &lt;-<span class="st"> </span><span class="kw">sd</span>(sk)</a>
<a class="sourceLine" id="cb37-3" data-line-number="3">std_estimate &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb37-4" data-line-number="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</a>
<a class="sourceLine" id="cb37-5" data-line-number="5">  Xq &lt;-<span class="st"> </span>quantiles[i]</a>
<a class="sourceLine" id="cb37-6" data-line-number="6">  std_estimate[i] &lt;-<span class="st"> </span><span class="kw">sqrt</span>(q[i] <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>q[i]) <span class="op">/</span><span class="st"> </span>(n<span class="op">*</span><span class="kw">dnorm</span>(Xq,<span class="dt">mean =</span> <span class="dv">0</span>,<span class="dt">sd =</span> <span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb37-7" data-line-number="7">}</a>
<a class="sourceLine" id="cb37-8" data-line-number="8"><span class="kw">print</span>(std_estimate)<span class="co">#compute the standard error of the estimates from (2.14)</span></a></code></pre></div>
<pre><code>## [1] 0.01252335 0.01742041 0.01740307 0.01251031</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">quantile_large &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">qnorm</span>(<span class="fl">0.025</span>,<span class="dt">mean =</span> <span class="dv">0</span>,<span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n)),<span class="kw">qnorm</span>(<span class="fl">0.05</span>,<span class="dt">mean =</span> <span class="dv">0</span>,<span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n)),<span class="kw">qnorm</span>(<span class="fl">0.95</span>,<span class="dt">mean =</span> <span class="dv">0</span>,<span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n)),<span class="kw">qnorm</span>(<span class="fl">0.975</span>,<span class="dt">mean =</span> <span class="dv">0</span>,<span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n)))</a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="co"># the quantiles of the large sample approximation √b1 ≈ N(0, 6/n)</span></a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="kw">print</span>(quantile_large)</a></code></pre></div>
<pre><code>## [1] -0.1518182 -0.1274098  0.1274098  0.1518182</code></pre>
<div id="conclusion-2.1the-0.025-0.05-0.95-and-0.975-quantiles-of-the-skewness-estimates-is--0.1541258-0.12914520.1211884-and-0.1472121." class="section level5">
<h5><strong>Conclusion 2.1:</strong>The 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness estimates is -0.1541258,-0.1291452,0.1211884 and 0.1472121.</h5>
</div>
<div id="conclusion-2.2the-standard-error-of-the-estimates-from-2.14-is-0.012523350.0250.017420410.050.017403070.95-and-0.012510310.975." class="section level5">
<h5><strong>Conclusion 2.2:</strong>The standard error of the estimates from (2.14) is 0.01252335(0.025),0.01742041(0.05),0.01740307(0.95) and 0.01251031(0.975).</h5>
</div>
<div id="conclusion-2.3we-know-that-if-sample-is-large-enoughthe-distribution-of-skewness-b1-will-converge-to-n0-6n.therefore-we-get-the-0.025-0.05-0.95-and-0.975-quantiles-of-n0-6nwhich-is--0.1518182-0.12740980.1274098-and-0.1518182-respectively.its-not-difficult-to-find-these-quantiles-are-very-close-to-the-results-of-conclusion-2.1." class="section level5">
<h5><strong>Conclusion 2.3:</strong>We know that if sample is large enough,the distribution of skewness √b1 will converge to N(0, 6/n).Therefore we get the 0.025, 0.05, 0.95, and 0.975 quantiles of N(0, 6/n),which is -0.1518182,-0.1274098,0.1274098 and 0.1518182 respectively.It’s not difficult to find these quantiles are very close to the results of conclusion 2.1.</h5>
</div>
</div>
<div id="hw5" class="section level3">
<h3>HW5</h3>
</div>
<div id="question-1-3" class="section level3">
<h3>Question 1</h3>
<blockquote>
<p>Estimate the power of the skewness test of normality against symmetric Beta(α, α) distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as t(ν)?</p>
</blockquote>
</div>
<div id="answer-1-3" class="section level3">
<h3>Answer 1</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw">library</span>(energy)</a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb41-3" data-line-number="3">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb41-4" data-line-number="4">n &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb41-5" data-line-number="5">m &lt;-<span class="st"> </span><span class="dv">2500</span> <span class="co">#try smaller m for a trial run</span></a>
<a class="sourceLine" id="cb41-6" data-line-number="6">test1 &lt;-<span class="st"> </span>test2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb41-7" data-line-number="7">para1 &lt;-<span class="st"> </span>para2 &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb41-8" data-line-number="8">power1 &lt;-<span class="st"> </span>power2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb41-9" data-line-number="9"></a>
<a class="sourceLine" id="cb41-10" data-line-number="10"><span class="co">#Estimate the power of the skewness test of normality against symmetric Beta(α, α) distributions</span></a>
<a class="sourceLine" id="cb41-11" data-line-number="11"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {</a>
<a class="sourceLine" id="cb41-12" data-line-number="12">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb41-13" data-line-number="13">    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,para1[j],para1[j]) </a>
<a class="sourceLine" id="cb41-14" data-line-number="14">    test1[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(</a>
<a class="sourceLine" id="cb41-15" data-line-number="15">    <span class="kw">shapiro.test</span>(x)<span class="op">$</span>p.value <span class="op">&lt;=</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb41-16" data-line-number="16">  }</a>
<a class="sourceLine" id="cb41-17" data-line-number="17">  power1[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(test1)</a>
<a class="sourceLine" id="cb41-18" data-line-number="18">}</a>
<a class="sourceLine" id="cb41-19" data-line-number="19"><span class="kw">par</span>(<span class="dt">mfcol=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb41-20" data-line-number="20"><span class="kw">plot</span>(para1,power1,<span class="dt">main =</span> <span class="st">&quot;The power curve against Beta(α, α)&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;α&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb41-21" data-line-number="21"></a>
<a class="sourceLine" id="cb41-22" data-line-number="22"><span class="co">#Estimate the power of the skewness test of normality against symmetric t(ν) distributions</span></a>
<a class="sourceLine" id="cb41-23" data-line-number="23"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {</a>
<a class="sourceLine" id="cb41-24" data-line-number="24">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb41-25" data-line-number="25">    y &lt;-<span class="st"> </span><span class="kw">rt</span>(n,para2[j]) </a>
<a class="sourceLine" id="cb41-26" data-line-number="26">    test2[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(</a>
<a class="sourceLine" id="cb41-27" data-line-number="27">    <span class="kw">shapiro.test</span>(y)<span class="op">$</span>p.value <span class="op">&lt;=</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb41-28" data-line-number="28">  }</a>
<a class="sourceLine" id="cb41-29" data-line-number="29">  power2[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(test2)</a>
<a class="sourceLine" id="cb41-30" data-line-number="30">}</a>
<a class="sourceLine" id="cb41-31" data-line-number="31"><span class="kw">plot</span>(para2,power2,<span class="dt">main =</span> <span class="st">&quot;The power curve against t(ν)&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;ν&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw">print</span>(power1)</a></code></pre></div>
<pre><code>##  [1] 0.3840 0.0704 0.0424 0.0400 0.0384 0.0312 0.0384 0.0368 0.0416 0.0324</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw">print</span>(power2)</a></code></pre></div>
<pre><code>##  [1] 0.9572 0.6900 0.4724 0.3396 0.2520 0.2056 0.1720 0.1512 0.1236 0.1272</code></pre>
<p>#####<strong>Conclusion 1</strong>:By trying the parameters from 1 to 10,We can see the power of the test against Beta(α, α) falls from 0.3840 to 0.0324.</p>
<p>#####<strong>Conclusion 2</strong>:By trying the parameters from 1 to 10,We can see the power of the test against t(ν) falls from 0.9572 to 0.1272.Generally,the power of Beta(α, α) is smaller than that of t(ν),which means t(ν) is more closer to normal distribution than Beta(α, α).</p>
</div>
<div id="question-2-3" class="section level3">
<h3>Question 2</h3>
<blockquote>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level α, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) χ2(1), (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test <span class="math display">\[
H_{0}: \mu=\mu_{0} \text { vs } H_{0}: \mu \neq \mu_{0}
\]</span>, where µ0 is the mean of χ2(1), Uniform(0,2), and Exponential(1), respectively.</p>
</blockquote>
</div>
<div id="answer-2-3" class="section level3">
<h3>Answer 2</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb46-3" data-line-number="3">mu0 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb46-4" data-line-number="4">sigma &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb46-5" data-line-number="5">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb46-6" data-line-number="6">p1 &lt;-<span class="st"> </span>p2 &lt;-<span class="st"> </span>p3 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#storage for p-values</span></a>
<a class="sourceLine" id="cb46-7" data-line-number="7"></a>
<a class="sourceLine" id="cb46-8" data-line-number="8"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb46-9" data-line-number="9"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb46-10" data-line-number="10">  x1 &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb46-11" data-line-number="11">  ttest1 &lt;-<span class="st"> </span><span class="kw">t.test</span>(x1, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="dt">mu =</span> mu0)</a>
<a class="sourceLine" id="cb46-12" data-line-number="12">  p1[j] &lt;-<span class="st"> </span>ttest1<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb46-13" data-line-number="13">}</a>
<a class="sourceLine" id="cb46-14" data-line-number="14">p.hat1 &lt;-<span class="st"> </span><span class="kw">mean</span>(p1 <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb46-15" data-line-number="15"></a>
<a class="sourceLine" id="cb46-16" data-line-number="16"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb46-17" data-line-number="17">  x2 &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb46-18" data-line-number="18">  ttest2 &lt;-<span class="st"> </span><span class="kw">t.test</span>(x2, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="dt">mu =</span> mu0)</a>
<a class="sourceLine" id="cb46-19" data-line-number="19">  p2[j] &lt;-<span class="st"> </span>ttest2<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb46-20" data-line-number="20">}</a>
<a class="sourceLine" id="cb46-21" data-line-number="21">p.hat2 &lt;-<span class="st"> </span><span class="kw">mean</span>(p2 <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb46-22" data-line-number="22"></a>
<a class="sourceLine" id="cb46-23" data-line-number="23"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb46-24" data-line-number="24">  x3 &lt;-<span class="st"> </span><span class="kw">rexp</span>(n,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb46-25" data-line-number="25">  ttest3 &lt;-<span class="st"> </span><span class="kw">t.test</span>(x3, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="dt">mu =</span> mu0)</a>
<a class="sourceLine" id="cb46-26" data-line-number="26">  p3[j] &lt;-<span class="st"> </span>ttest3<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb46-27" data-line-number="27">}</a>
<a class="sourceLine" id="cb46-28" data-line-number="28">p.hat3 &lt;-<span class="st"> </span><span class="kw">mean</span>(p3 <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb46-29" data-line-number="29"><span class="kw">print</span>(<span class="kw">c</span>(alpha,p.hat1,p.hat2,p.hat3))</a></code></pre></div>
<pre><code>## [1] 0.0500 0.0130 0.0489 0.0205</code></pre>
<p>#####<strong>Conclusion</strong>:The nominal significance level α is set to 0.05,then the empirical Type I error rate is 0.0130,0.0489 and 0.0205 respectively for the cases where the sampled population is (i) χ2(1), (ii) Uniform(0,2), and (iii) Exponential(rate=1).Therefore,the empirical Type I error rate is closest to 0.05 when the sampled population is Uniform(0,2).</p>
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<div id="if-we-obtain-the-powers-for-two-methods-under-a-paticular-simulation-setting-with-10000-experimentssay0.651-for-one-method-and-0.676-for-another-method.can-we-say-the-powers-are-different-at-0.05-level" class="section level5">
<h5>(1)If we obtain the powers for two methods under a paticular simulation setting with 10000 experiments:say,0.651 for one method and 0.676 for another method.Can we say the powers are different at 0.05 level?</h5>
<p>#####<strong>Answer(1)</strong>:No,we can’t.To answer the question,we need to set a hypothesis test to find whether the powers are different at 0.05 level.</p>
</div>
<div id="what-is-the-corresponding-hypothesis-test-problem" class="section level5">
<h5>(2)What is the corresponding hypothesis test problem?</h5>
<p>#####<strong>Answer(2)</strong>:The null hypothesis is that the two powers are the same,and the alternative hypothesis is that the two powers are different.</p>
</div>
<div id="what-test-should-we-usez-testtwo-sample-t-testpaired-t-test-or-mcnemar-test" class="section level5">
<h5>(3)What test should we use?Z-test,two-sample t-test,paired-t test or McNemar test?</h5>
<p>#####<strong>Answer(3)</strong>:I think that we can use paired-t test or McNemar test.Z-test is used to test whether the overall parameter is equal to a fixed value,while two-sample t-test is to test the mean difference of two independent samples.</p>
</div>
<div id="what-information-is-needed-to-test-your-hypothesis" class="section level5">
<h5>(4)What information is needed to test your hypothesis?</h5>
<p>#####<strong>Answer(4)</strong>:If we use paired-t test,We need to know the difference between each pair of data(0-1 sample ,two-dimensional) in every experiment,which is our new sample,then we should compute the mean and standard error of the new sample;If we use McNemar test,we need to compute the numbers of 0 and 1 of all experiments in the two methods.</p>
</div>
</div>
<div id="hw6" class="section level3">
<h3>HW6</h3>
</div>
<div id="question-1-4" class="section level3">
<h3>Question 1</h3>
<blockquote>
<p>Efron and Tibshirani discuss the scor (bootstrap) test score data on 88 students who took examinations in five subjects [84, Table 7.1], [188, Table 1.2.1].The first two tests (mechanics, vectors) were closed book and the last three tests (algebra, analysis, statistics) were open book. Each row of the data frame is a set of scores <span class="math inline">\(\left(x_{i 1}, \ldots, x_{i 5}\right)\)</span> for the <span class="math inline">\(i^{t h}\)</span> student. Use a panel display to display the scatter plots for each pair of test scores. Compare the plot with the sample correlation matrix. Obtain bootstrap estimates of the standard errors for each of the following estimates: <span class="math display">\[
\hat{\rho}_{12}=\hat{\rho}(\mathrm{mec}, \mathrm{vec}),
\hat{\rho}_{34}=\hat{\rho}(\mathrm{alg}, \mathrm{ana}),
\hat{\rho}_{35}=\hat{\rho}(\text { alg, sta }), \hat{\rho}_{45}=\hat{\rho}(\text { ana }, \text { sta })
\]</span>.</p>
</blockquote>
</div>
<div id="answer-1-4" class="section level3">
<h3>Answer 1</h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="kw">library</span>(corrplot)</a>
<a class="sourceLine" id="cb48-3" data-line-number="3"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb48-4" data-line-number="4"><span class="kw">set.seed</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb48-5" data-line-number="5"><span class="kw">pairs</span>(<span class="op">~</span>mec<span class="op">+</span>vec<span class="op">+</span>alg<span class="op">+</span>ana<span class="op">+</span>sta,<span class="dt">data =</span> scor,<span class="dt">main =</span> <span class="st">&quot;Scatterplot Matrix&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAk1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OpA6kNtmAABmADpmAGZmOgBmOjpmOpBmZgBmZmZmkJBmtv+QOgCQOjqQOmaQZgCQkGaQtpCQ27aQ29uQ2/+2ZgC2Zma2/7a2/9u2///bkDrb/7bb/9vb////tmb/25D//7b//9v///8oURBpAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAP+klEQVR4nO2dCXvjuA2GmXTTTbZtnE63h5PZ3TbuNOpEdvT/f115SiQAChQlWU6Nb56JL/DAS/AwxSiqE41KbV2BS5cAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBGAojRbECN0rp7HzP599vwc0wfzzijPpUp59a8OD3pZ/ucGZ3LDM0EpGvjBGs86PRk/HI/2cyAa1EqA+jmVT9pcXFJ5pcFqPF8VN79g/3sMGIRhF2LUumSfvewM09u/ggBlWReq5mADrZVTRzZKg+te3zwLX6w+P4WIJqX98agUTe/PWgL7dy3J/dZAGTT7rqQ1vmuAf3+yaQ8mMz2uIg3n+O/TC76M52VznA2udmAbA10fXqHrG+te6arnwCy44fz2cXe3btPY0w9IB+V+ikA9OOzfn56uvvFAoJFvPkcv9tcGmPTjnX98wDqRwaj1rDRDG7ftKv3AVvcxexPbbGzKW24HCyC1sSVA+Qav1FD2lDS7qCLOj7srPO4CJ+jy8X8/O/TAqPRQoO0bShfz+BT43oTQqM/0M+bPpF9PDisNmxsBvYBAGq1aaP2TR8YSRH+bR+HGt2fhrar1+xpvu0H6XiMDeBSQHbU8P2i8bX3DMxLm0HIpXGdJwF0fLjvdBQ5EqgIn2PI4OAHsplaYqHYunq6oLeyld/rgEkBtSoLyAwX1jWXyL0BAenx5/uzHWz2RBEA0PFhiQCaCcgPznEPid5HgPTb/aBZEUGaoJ6n7t4tO1xECsgCXGBBNA+QmZX27rEfMVpdTTd9oEE6RIfRAKh4DDIR9XedQzvMUOkgHQPSr35doo8ttVA0noepSO3tTGSe3Yd6N2HFsjeY7DTVA8rPYs3QSyygRvVsckUMudzrZ/M72VJfNXyrq344irHpT9t4HRS5E9JEo3zTJ/VpbUmNpxLiExcRA3JLRENpnn+LzWK76IV5bqpvphu/eHarObcWVNEY09nu8Z/neAXjl8husDr0yyxr77qyG8pQETGgtl+Kz10pbr7dseb3qCUkgBgJIEYCiNHmgC5dAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGIkgBgJIEYCiJEAYiSAGK0KyF8ZXuCg1+nLG8qncVcplzhGNqJVATXmIvT+9OfX4x/mXbmwx1iJfPTrBXIf1epdrNkdH98/XmYdIvj4+k1HEJHPYU+9u6jWBqT7RntvPZmbTYfz0XCId5fVyoB0B1jEBRrQwZyn/dSAjj+9dot0ghPVxezI/am7mBs9lxhGDQuUj+lhi+Q+plUBHRabiKlp3vauRRYRY5KFIiMBxEgAMRJAjAQQIwHESAAxEkCMzgBIxQUlL6bno/qH+OmaulJAbf8rESWlrqwLBPTx7H7z+JH/danrBGS/2vUPbKkr6wIBhQgq2Aa4TkD+t2fXHYNUTkVGahWjEStsW+jm9CRMSjVqZCup/6u8kbIfu39jxXmH6fISGAqlPj7c/POp6LdEzgfIo/EtSfjufRpMFDKK36IjqH8M+MjQ+fhqLhd1p7+uOYtNBBTRQb3H/0TdARilCXOAkobw0QgB6enLbuKuOotNAwR8pwBhhKlR0u0y44ryA3dcEgzYro+gdddBkwDB4CABQVGAkn5DAEoxo0yDXasubAxifCdtFKBIfI4BdSSWmumLcbM+JQZE+cQDQrNYESDSbCNAL7/aG7L4O0S4+3DptRcChDtFESBqDKoEhKf5CW7Wp3y+78ztWMx6/bDzJzm69o4ARFS3IILIQZrxnUY4pKtwc3qSkPLltTMXffV0YNcUX97cVxsMiGp0FhCsHJzjUsvBimKzVRcbAJk7Tty8ulkTrUuIcbMOED3TjQHqSKNpbtanjAC5BRcdQbBnhHdhHVJ+NCAUIR0EhNviEgCZMag1dxTZa0gYEFpCU4AUwshQ7AEk5eEAw0bT3KxPGQGy01d2FsNO8b0HVS7TxcYBhf69zSBd8j4RHNiqFJBSaDwjuhj+dKsIKnlfoW9YFCBo1JGABkRxXiWALnslnbrfkRHUu5NaQYrA+W4UUNdnpHBlz3FVYwIgFXlHWA2jBBgrEMW0l3lqHbRKKCs05HVnuqqhcioyUqsYjVgltpd1VeMCdVlXNS5R57iqcSUSQIwEECMBxEgAMRJAjAQQIwHESAAxEkCMruXLar2bFUnoMukKl5SbyWncaDDMZOs/UYo43TFB81Oqfm8KXxKcDihp9VFAlFH0Imqubbdcw3ZUJuRLyk2aPdpgKwmzbHkbdrE0JdxOnhdBebeKjOD+f3Y8KNeslIpUUfa07yAjykgRl2lTK7ZSU92cnGSoP1WTekAoI2RU0iB8q03zdkZKuibVgHBGwCi8PwaI+HwzQJmKAEDmysHHy2t8ggiWSwNC03zR+aDcSqjezfqURC0IQObqtIYUnyCCZ0Ay5+bQ/F8CiDS4GECKmsUajWaXnCCC5SpqaEVGWefHKzVcP6x0kzeBVyFpMipUBAI6Pn5/SU8QId8JQNgo1yIlXzVWBZS7CknXBAP6ePnt8T05QQTLnQEIlQe49I88iYz4lLmrkHR1iYViY//CVXSCCB6zAu70OaExiOpBoxEULlGfJYLgVUg0rVA5mhf2HjnxCSJopZLMoukdT/PpYO1rkVYq+WoYAK46BmWuQgJAdI6l66AoqzygsE7mAEXh2J0DEEqSBnEHzlhUAoq3S0YBJVsHGUD9Xkd3DkDuz5iRY1B4jAfBCkBD90wzQ6vJwfe+u6HyAuTBbKwerMrGoPb2DQPKJK6KoOR5HhBlRpcHRubVZ7HTl28CKCN3C7XTz2gWy6nIiJjmFzDaZk/6+GDm+fay/wzYaqpHeyUSQIwEECMBxEgAMRJAjAQQIwHESAAxEkCMZnxJke9ik1KqsH03+m1ehX2u/Bf1zAf0zkHJlVyV7kFO1FKA1FCRkez9HpZaCBARQcig38yu1EIpsyEPjDrKqgrQeHlDPKvtrqxG25pxbTOAwJAwF9B4g0SROncomgMI0RkBBM1mAsrE4gBopLhpmgfINVJ8yYaqMG7KnO/g4lsWUDYqqDarDB2q3GkpcwJGqDmR1QRAmDUClD0BU8dpVgSRVUAVJq4ZY9/N1Ul3Wfr0pH74+RVVDmdCAyKrdEERhMcg3kq5P3Gj6fh7EbU3FKBMgSBiycvz26yDMq3JhzxcTvrn7vyQucoU/hYNAESzLllJbzNIFwFSxKABrezzg1K3BpA/socqVwuoP8RQ62Z9yr781Hc2glC5pos97X0XG4kgukX4CIrer3BzepJsXbqOAkTygYDM4HP86XV0DMqcSBoBNEQOdPMs9+4oBZSOnES55nmj1A9/2ftZ7EcygqI4iDPLdOkuLg26eZ57dxS1qKs1jvHRlXRYDiGjODbI4Aifwu+xoPiz3Lsj1BLmQCz9QW2hVfKJ+cuaIfQTo+SMTPQh1cV8wGWKONO9O0BD0jkO7U6SY+oAx6ChuFzvUf1Hac1gEWe5I3lHLy/wIN2hBq0EhHIhyqOrBXt4ua4FEHidOTXH1GGaiCEat1LWSK1iVLonnTs1R7k5Gcz/g3Kn5ghdJ6DcqTlC1wlowqm5KwVULgHESAAxEkCMBBAjAcRIADESQIwEEKOaDQBGZbarGF3YASoVfiYVITfMug7Y5bY7EpPJeyLDNuOlACIqktsPSs0yvufdmgRoiXMvXLkjSQYn2WjuAY1ZKZjzzAjiKjXN2zkpFXEuoQgQvaNYZDTuAd0YGwGiha4y0OFD+I5dqgGUq1a1mxVJBhYUHnSVAdW6IwERLlUAymm6m1y5fMrMlUMCEGOliOzQNr/qzxA9/mIe/CsCEId6opv1KXEU4RxpQB0PSMGsVH+G6MHeBsS/YiOoQ6gnulmRJCcix0yDkoDGs3LP/T2I/CVRu/fOjkGVbibl1qXsm2gEEDEGISsMiKiceR7OEDlA9hUFCB+V2BbQaAR5QPHBDGSl4uxybqnoDJF58K8uERAO4myzU2MQtioEFJ0hCpzMjXdGx6AZbpanzBw2ykFiFm5EuUqlZmTlVHyGyPx3r8YB9UcY1gRUeIuuLn/CrCO8B76rEkAFHuQabE1A6LAR0UpxjbYFlIxB3VkAZW/R1f/iQRiE6yNIkSPrvAjqu26Zm0XZ08rdois0URd940IVHixT59EYNJz4pitXGkEOdqidOsMYhJNEfSvKJf6Psu+jiCo3auj0y24VoNBcyUebrINyKjJSqxhd1JfVK1HBLPbk2kBusJST+d58vSrpYu4Gx1cqGYMYCSBGAoiRAGIkgBgJIEYCiJEAYiRfVjk3Z6UMuxhD1TLbHcm2WQdqDDY4BqdGtzsoo6w79ZxmAVLDRtlAJwdoJDg62qoIED5NkqlspeakjDaS071OIntkR9ehiCIwLHFnmwgK+9FDENERBAAq2BFpQB0RQb2L5Bb2iDubRVA37jqxac8AijLERsM26ucAhA6blFzVGAPEGcV715+hixEhBHP0bwDPM4A4IzVc/eABpZeptoogalStHoOwRWqES5sAaIsISpqbdj2MqtgnDIjwGwJSqFNT66DW7J/bv4gXDqFtFEHFR/CwHQEIeg4rl56iGQFkrpE39/aETDiEdkmAyEOcyJIGhLLBY1AJIHeNIT6Etn0Xi6tbAKhjAXUEIBoR7mK6Y928JofQtoogorYIEBVnsFxiDCIB5ZoEu9PevceH0HAEbXODpcGzOHt6XlZpTjg/ZERHEC7PXKRygPpDaMjN89xgKVNZBAiOvpTvwIioXKY5iGWF61cfz7dv4RAacvNMN1gKDqv+pEcBoI4AlM5PHQ2I6Ko0oNHKOp3nBkuZRSKqcMSRPrADAGXOyERB1MV2ZYDA67PcYAm0eTbkk1ijylVKxUZ05dBo1i/AS9yB6Mu19CANKpE1YoeXKqOL23LN/5yemaIeKjNS8TM4003OcFbKzwlowpmn6wQ04czTlQIqP/N0rYCmZDgrpQBiUgqga5cAYiSAGAkgRgKIkQBiJIAYCSBGtYDacM3SqVHmBtbgzSKZe9jjpFX52S1mmKa+Zk6VgPS34XhD9/j4/vG8B2+WqbnvcNKq/E5Pt2+wYnNq5lQJyJT7MuwYNDvizXI1O5DUvZyW38dXc/9smKYmp0SVgFodtochaA//MPeIB28WS3cNmPT4cPM6OT/TxVCaqpwiLQTo7l2/rKyG2bwCSds70zGWAFSXU6RlupgpHPWT0qzMtU+iy7b3U/M7EV2sLqdIywzSroWqhkKXAuZnInI3NT8DCKapyynSctP8rm4yPZjN8x1Melhsmq/KKZIsFBkJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBG/wNZdaqpJ2RBIQAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1">cor &lt;-<span class="st"> </span><span class="kw">cor</span>(scor)</a>
<a class="sourceLine" id="cb49-2" data-line-number="2"><span class="kw">print</span>(cor)</a></code></pre></div>
<pre><code>##           mec       vec       alg       ana       sta
## mec 1.0000000 0.5534052 0.5467511 0.4093920 0.3890993
## vec 0.5534052 1.0000000 0.6096447 0.4850813 0.4364487
## alg 0.5467511 0.6096447 1.0000000 0.7108059 0.6647357
## ana 0.4093920 0.4850813 0.7108059 1.0000000 0.6071743
## sta 0.3890993 0.4364487 0.6647357 0.6071743 1.0000000</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw">corrplot</span>(cor)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAIAAACb4TnXAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAeQklEQVR4nO2dT4gk133Hv696Vhb4IIxPwY4jie61sx4Ri1ixqJYCcmRM9xIYhDMYE7xYh2qUg7ovC04yIQcPmLAHV/siTx9k1obgbIKZi7tyUCSINe01JpGNxhNrqyPLiQlEByU4mESrnXk5VHV1dXX9efXqvfrT/ftQh9nqelXVu/PZ96feqy/jnIMgCD0YVd8AQWwyJBhBaIQEIwiNkGAEoRESjCA0QoIRhEZIMILQCAlGEBohwQhCIyQYQWiEBCMIjZBgBKEREowgNEKCEYRGSDCC0AgJRhAaIcEIQiMkGEFohAQjCI2QYAShERKMIDRCghGERkgwgtAICUYQGiHBCEIjJBhBaIQEIwiNkGAEoRESjCA0QoIRhEZIMILQCAkmzIChO/Z/dgZgDON5pTdENABGAXxCDBhObZwMQ7scsD6sKY56ld0VUXtIMBEcsD6mHBGVnAH6AD+q5qaIJkBNRBE6MIE7aw3CO6dV3ExDccBY3Dao+sb0QoKJ0Ma+iVEHTmjffIzRDPb1ym6qWQz6MG1wDtuENQXncG0AmG54/U+CiTE8gWujH/qvt3MLLsewreVymzag4mAC7F8FgMu7OL0DAO0hbBOH4/SSTYcEE6Y9BOeh7QR65IoOqPSOwKcYdTBwUovVnsttAOhcwezM33N1f/nzhkKC1Q0HE+BguLqzh6mFyXE1d6SAUCe2fRk4RaPr4zyQYOIsuule422gqdlW2oBK0qjDYlNZX3qd2BsAgB6sGb43B4Dv3YJ5ReFl6ggnRJhaHCZ3ObdNbtreLg5w21V/LdvkAJ+G9ri2lmtNrehpvT1TruXbWeCW962mHOAAh6Xy/CsEl4hs+q4YDwkmgsvNxW/bUjDPBD3/YJ5Ry83k6kV2uRn8xocIvmD4mzYOC8tv4X1H76907evqhpqIIriYLfroYS7v6rpgGQMqLmbA3to0lMu7/sBD8EPzqNGgJQkmQkK/6HjS5C5EcmfP+1KKe31zdMt90FyPQUsSTIQ2DiyMrq2MfY27ccN9qihhQMX7Up2VMzsDjGY4GAJz3JrB2lN2tUEHM2u1WvY2HQ+a6zRoWXabtMFM9feLvOuUOKAS/VKLLqWldjxA3/0nEO4eW3H957IgwepG6QMqZTCtYICh1EHLRHaqqzuJWFzMgIMSB1TKoAMTOHbQK3Fpz1GwTKSH6paMUB9MkNImg2/kgEobBxYmfaUPr1NwwLox/S5nUP7kfRJMhDm6i8ng2vvougdUsiZwaPlfw0F/AmBltnT5y1WqWF5ECy5FSFhwqfuKS0y42uYWbxIDhknqAbarawFEAiSYCHN0O9gv+9+GkMUBO6zJf0nURBShjZt2tNm2CZS5yrjMa/U0LibKCQkmzgydUrorjJW09KvMVcZlr2h2lqtUx92Vp/YlU/6TgQaSMC9WE1Ypj7PDD3+n1soDN/VPY8u8Fuc8NNnXm+Pr/dtZJf4jLqAaTISEebGaOFoMUU6tlWpTR7VW5oS98q4VWrTqngGLf7u9ChatkmAiJDyb0k3vaPEwwIUJ1b8cZU7Yq25y4PEEsPzh30reAlZyjdlUXFtnay0Bb/ljsClv3pQ5Ya/kyYF+a3DKgZX5nKU3EUkwEZKWx+qY3uZys5w+GOe83Al71axo9v4Cy+1Fh6DnYHWD3si9UZBgBKERGuQgCI2QYAShERKMIKSYj7ss+9EkCUYQEjiDzmgmcBwJRhD5mI+7jPVPLcsUOHh7XxnwyiuvVH0LRB156qmnADDG1j/yh9wvH7i8156Pu5PseV7bKxgWf5Ul8Morr5RzrdIuVOa1Sv5Swc+XPvGl4Of3fvzN4IFWO8+bRbZasFzc9+izwc93X3uxwjshyoEZreInIcESCRuV8hHJtqmwlgI7SLB4UuyKPZI02zwMFYLRKGIM4nYVKULUHGbsBJv0SagGW6GIJ6qqss+9+MPInr979lMFzxnL52/+KLLnO9ce03GhhtK6733FT0KCLVFSC9336LPSjq2rFd6vULN1tcL7STOPjIqrPTwRmCdPgtWCJLXWjymoWZJa68eo1cx+9c3IntETDys8f8ALt9+K7Hnu8QflTkV9MJUo7ETlPZWIXXIHRxCxS+7gFOxX31y3K2W/NC/cfmvdrpT9mbBWK9ik74oEAzQMUYifUEIYOcckhCnuWKZCqhzLVEjCMaO1E2xydwUSDJUOAEpXR3kLSqtSxDFBeYo7JihPXseUjCKSYLrY8oH7XNoUcSyXNrkOZq2dYMt7VwEkWGUU6U3lKl6wpSdRXEIYOcckGn7iRYxWK9jyXmV5EumSBLHZtC7d723GpV8BYIyxpBWW83GXeXQjYdp1Emw+BmNwQikB47m/09vCXy544ThbCwgPf5S15FRfQ+7uay+mnLxg9SV+EiWDgblOIt3ey1tQbmxQvGDQPrz7T38BgHM+tSb9mN8oZ9AZ7U4559y1MeqsHFEnwTz6h3C5nxIw6qBz5r/d1jbRXyQtjLsYwT/MtTHqLB0Lf8SnmPSj+pXFlvfBNoCFYGf/53a8Pb3rtjk5jho2v3MKy3s5d3t4YOE0/A7o+glm3/SDZ67uA4B93d9/dR+YwAHgYDRbHtYeYmphdANY+8gL56VQL0IKw2gZRqv16/98D7/p72pf3l31BwDaV/cD7Zzjibl/NfQbVz/BLrfT/gjAOQZMhL9E54rv3vxOfBGCyI8/fmi0PE1i1zgDANrDE/fKIWOMscMr7snK/+j1E0yI1aiuzij0kYlOZbcVhhawNJ3FU2bDAEPwvoAYnAHr3Np3Oefu/q0Oq3kfTAhz0csKbf467hncau+N2BCYwZiRXG8FzO+cwjoYttGMPlgmvb1Ei9qXgXw5Q/rqmfRp9UqmxoucRMmc3VwnkZ7Fm7eg9CxewYKGwQyDGR/40H34N3/X/M4pdnN1QRooGHqwTfS7y4ypAQPz/tiDbYbClOfolhXHSmwcO5eMnUvGzqVPPrD7hrfHuTGaWWtBjO2r++bkcDwHMB8fTlYNbKJgwPAENpbdsIm1DL1e+aiD3frGlBSsxMSLF6zEJIpLVGJy9Z5EJSZexG8iGuz9n/lLAIyx/sSaLn6dnEHwULk9vGlj1GGMdUaw3ZVfuDoJ1h6GulJZfxyehDpgq0Ha4Y8E7NLUStzyQY5cwhRZG5bLsVwHGwtaxifhR1Uuf596R3w5Xtgenvh5YCeRp0J1EmxTEFdLuhLLW1C6EitS+wlqU3zlpaA2eas7o8WCTeKu/JNIl9wkFNY23gwprY7JaSmhSvEBkkx5VK1rzpRHojEZNBGZQYIVRpVjEu/kyCVMkZ5bLmFUvTJg9MTDsRYl7ZfmuccfjLUoaX8m/iiiwYwCgtE7OVSSPsE3BU+b9Mm7Skb2PW3SJ+/qeOmNpjdwrCM9dr9OEa8CSLAl0noEZYu8UgrJmil/bVuSZvQ+qTCtSwradyTYCp4eeTXL2+9KR9NbENchndIxDAWCUR8shryqKLSLqA9K+mAkWDx3X3sxyZnI/pQjiUbDWmyx/QfSVzQnL2mmJmIaYXOCdiPVV1tCUHH913e/CIBz7gxYf7DH12YvOIPOCLbLh+35uNu5Nr66fNxMgolCUm0bC8F++M7tjwM/hbeiuXPsHEUS+JzjiWm7/nT6Ez5cOUlZd0sQDcN/yvzOL3+Nh/xdsSuaU6fYb3UNVmZMc2nXoi+lCqNlAECLAQwAY4zzacxx7tnMvIJxl41mAKzpShNyqwWrbZyxdIImZTQXv1bw832XfMFCK5oTxjhmo8N9l/M2nAHrd8OvDdhqweoDxdXWkB2vD2Zkr2mGad/0lOpdt83OmYvFa5eoD1YDcsXV0tvgSmOnZey0jNZv/NYD+Lm/K7a71blizs6S3lNBglUMxdXWlh2D7RjskmF+6Pdf9/YkrGgeHlj+iub1I6iJKISO+YGVx9V++uvfX9/58vNPFjnnJrHT8qufDz87xj8OGWOANeXLFc3BO9p6R+6dboeNgPAR3knKvefmoSnWtdq42li1wh8p12x0/Hpkj733iNpLKGdnOUPKxNpr23pHYZHWnn8FJ9F0cxtAabGuZZKi1vphSjRbVyu8X7lmhy+9sb7z4OmPSpxqp8BC5gDqg8WjNda1qrhaQbukj48wOn49ya5cxwhy+NIbsXalf5TCjmEEm/RdkWAxaI11rSquVs4WacdyaVPcMRF/8jp2/yUj2GTviwRbQ2usa1UDgEXqIomyEsIUcUzcnFyOecP03iZ1XwAJthls88B93npJ/HhvmN7b8t+XDwm2QmmxrmVSsCuV9wzSdZFEQYmelXipnRYLNomr+CeRLkkQm02RsY0AqsGW6I51rSSutnj1les8BYcrchWXq77Ey4ZqsH9HxopmAN6y5ugBNRbMj2wO7XEGi5AHZRnNm8E298H0EXTAfv71zyIto9nHuTGare2ssWDtqzCBcCLu8QTmPtrNyGgmms5iCPHVn33vUW9PfEazhzPon5rm2u4aC4Y29k1Mjhd/dDAB9q9SRjNRDvdfat1/qXX/2794Gx+DFyEbu6IZAObjQ0xv7q9/UGfBgOHBIvg8FM1MGc1r0DoxHbQM1jJYi8EbQ0yOkMV8fO3W/vXYIJ96C4YerEUrMWgfAo3IaCaajt8Hyw6RdW7c2r+Z0FCquWDAnoXJsd8+PAjmK2vJaNYd61pVXG2ZFJy8W6sp9v47EQ0AaYo5gz4OEvshtRestwdMMDgGLF8hpRnNG4+qhSc1XCcmN0devGzLQMtA6yMPfRg/83fFrGh2jieY9BljjHVGM0z6q2P5tRfMayVOJrD2lnu0ZTSXFuu6wUjXQrWqvhDUYOzTn3zmn709cSuae0d8gWubsKZ85a1S9RcM2LMAIPy9GpvRXElcbfHKp4bVl4dcJSZYyh/kMNgn/vwm0jKa02iCYL2jlXRmD3UZzRFKi3VVQk26XhEk6iLp6iuvY+LHB4K1jE8jPaPZoz08WXutdhMEKx2tsa6VxNUWqYLkyuYSpmDjUNyZXDa+r2UEm9R9ASRYElpjXSuJq5XzpIiZ9t4jmeaIHCOCiDl567pluIrAmxGToNn0iZQW6yqHRB7ny88/mWvur5Kul+dPCS+98fxR+E6OFkXIloCmWNeq4mo9ZzI1Uz6qUdoIYZGx+wgkWHnoqKkqjKtN0ay2A4blU6RlGECCVUzeqkzhpA1yKZ0ibwpYnqT4KYiCpFRlEf3qOSi/qah4LSIJVhsorrZuhPpgb8JbrhJN/1owH3c7/mpLygdrACRVHbhv8fjrB3/2KaRlNDuDzmh3yk96WM8Ho+dgBBHPYhrHP3z/rx/z9sSvaHaOJ6btrwbrXbdXs4y2ugajtNWmXKuSCFl/kOOt+RwfB37kRcju4tadOXrhOVIrMRDu2ep7ObZaMEpbbcS1qoqQ9aMtGfOaeWkRsgvm48OJabvUByM8aIgyhbzPwebjbme0O+UrU4BJsO2CwqDF8d872kpdz7xgPu52RrBdmk2/xVAYdC4MxgzGjIc6l3Hm74rNaF7WXdH1K6AabHuQC4NWVZX9zp9O13f+5Kt9JScP8/jhS5E9tw+eljvVoon42c988XN/8y3AX9E8jT4Hm4+vxdVdHiSYEJ+/+aPInu9ce0zTtZRPEawwDDrWq/VPi5u27tX6R3lNCzIf/uBr38W3nknKaPZe6DvzI5qB1WfNJFgG62qF96vVTEd0coVh0Ol2RY4s4liKXZHDcjkWGuTwX50d/jQYnO8d8ciS+jAkWCJJaq0fU1yz8qOTdSNuV3C8hGOCakWOF9TMUDGbngY54hGxS+7gdfRFJ1cVBp3XLrlSee3KW9AwWLDJXQgkWCwSwkg7pi86uaowaDm7ipdVTostN2lIsCjSqkgU1BedXNUge3FDBM8gXX2JF/eH6Rkr0lbcAMGcaIwYoY10b1XVP5nnKWiX4Emoiaiegr2pXMVLjk4m8kI1GEFo5FKLBdvqJ/Nxl2UnygJomGCDUGRR0jdbHtPFOBQ5K0DB6ivXSbRGJ1cSBq12fCLlbErahyKnSqrB/PWVWYmy/kkU3GY5DBgw9V+IHQl/CB8zsfxjprsYTSq4z41mqyYoJrx4dLm+Mi1RdkFTBHMwMRFkCF7dj0kwmo8xAaaLh+q9I1hl3iGxaRjGclsSnu+bmCgbOonOO1RIb5mf4gxWIy0XuGfLDDGPPTKMkCfSRMxOuow9ieq70sa463eu+oBrxxxw57T0e9o6tmqdGAMPNqRmNKfQEMHmY4xmmMaFFQVc3i33nohN5+J8ucnSEMEizT/3LOaYzhVgsjK6mLNOUzI1Xt8yFnE2Owxaen1X7lPde2+5BYT7XQnrL8M0RLAVeRz0J8BaFnN7CAvoD/w/OgOMVl/wUyc2LzpZ7epJHWsxcxNfg/X2rNnohoP4RNkoDRGsPYRtou894DqEy2EhlMW84IjDmiy7alML2EXqfzARCtY/dai+CGXw8+UWonc0tSb9SKJsEg0RDOFg2BO0gaPFD+itBMweJeTK1g+t0cmVhEGXhpJWYvZJEvtgQfB5dkJxcwTLZD5eneHhoD+BfT3vaaRroc2uvkTUUtWuEzlPQceEim/RIIcI7SGm1qIZycD6mHKsv+ZHAAlV5OzSGp1cSRh0ccdq0fvyuLhYbrJskGAAekeL9iFfaTfmJ5cwReourdHJlYRBFzEkV1npSky0INVgWvnOtccyzRE5JpO8jpU8cihhqZxjEqVuHzydS7Ncx3N+Hmx5byyABMsgSSElagW8/PyTItoIHhamSCUWJAOW4FiRek/Qmdw13r27y00WequUEOUMYGiKTq4qDPonX+0LrmEp3u8K5FH44tEiXa8AEqx2aGoBVhIGHZhT2pt9Fc7zKNL1CiDBtogKw6BrNDYoTlSwICg2R5AsCbZ1UBi0KKtjG0FQbK4gWRJsqyGp0litwY4X0Xq967bZOXaOeiuGOcfL6L3eddvsnLlAm0YRCSKJ1edgGQuZe0eh9KJlkOxW12AUZ9yUa1WS0RwZRZxhAghNcA0HyW61YBRnXOa1pAdRqspo5u+9G/7IFHvHSyRIdqsFI7TS9Lha9+af/PZf/RQA/uirgkXWg2RJMEILueJqUUvN2l/42ntf8H++9Lfw+l29tr+QeS8xSHZleJEE2170PfytNq5WFfx8ZRRxz5r1bzjDo16uIFkSbOvQGutaYVyth8qJZuf3wn/qHU0t1mcT5AqSJcFqx+j49cgee+8RVSfXGutaYVwtdATwxi1kPlrblR4kS4IJYb/6ZmTP6ImHlV9lXa3w/uKalRPrWj6aAnj5ag0mBz1ozsB+9c11u1L2yzE6fj3JrlzHpKA71rWquFp9Abw4P19uspBgaWQqpMSxXNrIOaY71rWquFp9AbwA+HvvBpvEVTxIsEQE5SnomIQweYvojnWtKnJFXwCvBz+/F2zSFyLB4smljcK2onJKi3VVTvVRSdRE1ISEMHKOSfepinTGNoMSAnj5xb1gk74KjSISRAIFKq4AqsGiSLf38hYsWAuJFC8h1rWSuFqtAbwBa30wsWjm+bgbOqDegsWHMjtgDI4Tn9cskuNMNIG69cEEo5m9KR0BNRYsPZS5fwh37SORHGeCEOTi3nLzVjRnRjM7g/6paYZ21FawrFBm+6Yfm7L8SCDHmSCE4XfvBhuACWZZ0czz8SGmN/fDu2orWFYocxB71r4sWoRoFJVPrr84Pw82CCy4nI+v3dq/HplNX1vBBEKZlRQhiAT4+XmwCRzu3Li1f3MtbKSugomEMhcvEof0LN68BQtO3lU4xb4IGxxX+69//80HvvSVB770lQe+eSfzYGfQx0FMlk9dBRMJZS5eZNPZwFhXAGUF8D741B+/840vv/ONL7/zhYcApEYzO8cTTPqMMcY6oxkm/cVYfl0FEwllLl4kAYlKTK7ek66FalJ9bTYX986DDUBqNHOQecm5a5uwpov0y7oKJhjKXLBIMrmE0bE2rEFUElerNYDXI9IHi41mdgasO077DaurYBAOZQ7/MbGIDILaFLRLoi7KVaTMWFdVVD5+6HFx7yLYAMRGM6+8btSjPTwJHVBjwWpApjxK6q5cwkgIWUKsayVxtVoDeAGcv3s32KQvRIJlMHri4ViLkvbLYe89kmmOyDFJlBDrWklcrdYAXn5+EWwSV/Gg2fRClNPL8vzR9NIb8Ti8SKnilxYnb4gZgJeffzLX3F9xJ72xjYKQYLVD3whhXsfy2iWhR6Ss3LOvlGTQ9cPEEXu+nAEJtl3ojnWtKq4WGgJ4F2MbhSDBto4SYl0riav1UBjASzUYUQit/asK42pVcUGCETWn0XG1PNpEzMpoDoU0m7brPR+jYXqiJO6+9mKwVX0vQkSeg2WuaHYGnRFsl3Pu2hhd8yZ4UA1GEPFcrD7+ysho9kOah214kzmG3t6tFozSVptyrUoiZPnqc7AJZtPliuZbflZYQEJo2FYLVtu01fpfqMxrVRUhG6nBMlY0u2cz8wrGXbbaS9tqwYiNRNUQZe7nYLPR4b7LeRvOgPW7V9yTYZsEI5qPpjDoX/zLD/7wx/8NAA//rlAB0/ZfGdC7bpudMxcgwYimoy8M+sMP/95riymoj76ZldHcuWLOPKdWIMG2l8cPX4rsuX3wdCV3Io3WMOhIEzEjo7k9PLDY4fh6b9hG6AgSbOtY92r9I+WmqYxOBlBKGPS9d1dGEdMzmgH0jtw7XT+kOTiCBNsuUuyKHKbKMfXRyWWFQa8NcqRlNANYef61gAQT4oXbb0X2PPf4g5qudfjSG+s7D57+aMHTCqoVOb6IZpqik0ujyDrLAJoqlcELt99atytlfxEOX3oj1q70j0TIa1fxgvqik0sLgw7Fg3HpS5BgaWQqpNAxEX+KOFYm+qKTywyDXnvpjQwkWCKC8ihxTNwcCcekayG54vqik0sONLo4vwg26ZM0XzBnoCMHLJc2BR3L60yu4wvapfAktSXJW2oiYvkGX6VICCPtmFyrr7ZtxRKik0vj/N17wSZ9kqYLRhC6WKvBsiJkg89Db/ttjmDz8TIb1ouHnY/B+gDQZ+iO/cMKR8hK10USBYtURCJlFTbtRE6lNTq5/DDoSB8sa8Fl8Dl3bYw6/hENEWw+Rme0iCbimFroM7hD8CkATDlOhgBFyBIyJPfBVkYRMyJk53dO4UdCtIcH1iKKpSGCRaKJekerr6f3oAhZQiURwZaRRbERsu2r+4F2zvHE3L/aBhojWG8PmIAN0g+iCFlCIfycBxuAGdKH09rDE/fKIWOMLacnNkYw9MBdmJOM/hVFyBL5SZqReO+CBxuyM5qdAevc2nc55+7+rQ5rVh8MANo4WfTBLMT0rxRFyBKExy//961n3j575u2zZ371P9lHz++cwjrw33nTuD5YhKNpTP9KUYSs9CxefdN/pVG46qTypWLlh0F/4L6PfPuDH/v2Bz/27fe/HxkRsok0RDBnABaqspxjwERn8Ufve6uLkC2NInPki8+vV0450cmlcY8vN2REyPqDHIfjOYD5+HCyMLAhgvWOMN1FZ9EB65/CXaRdWsCog+5YYYSsRF1Uw+qLKEikD5YVIdse3rQx6jDGOiPYrn9EQwTDYmg+nBDrccTBF8/B1EXI5hKmiF1yFZF4KSVNO/GTaI1OLjkM+h7nwQYgO0K2PTzxD1jua45gpSOoTfG6K69jeY8v6FjlvS99pBt7zpebNCRYGpnyqGoZijtTw65XBK3RyWWGQa/VYDKQYBk89/iDsRYl7ZdGxBxpu6RrIbmCWqOTSwuDjgxyyEHv5BCinDEMzx9N7+TwVBGf/luwZagvOlkJIhGB3thGQUiw2qG1EXj74GkRx5T0uzRFJ6OsMOh3STBCgkCecl48qjw62aOEMOgiXa8AEmx7KXN4UFMLUGsYdJGuVwANchDNJiUyM7I/b7jm+QUPtsSD5uNu0gJnAFSDEZuBjjBogSaiM+iMZqmz7EkwYtNQNY6f3kT0As9NyzJTl4lRE5Eg4sl40Hz5wOX85PqV9JMwrmKopIlUEvtL1B8vrpYxtv5RjCzzcbdzdhCanRhhe5uIpcX+Ek1EVcVDTUSCEGL51sO0UcMo21uDEUQuYsK/BKAajCA0QoIRhEa2dxSRIEqAajCC0AgJRhAaIcEIQiMkGEFohAQjCI2QYAShERKMIDRCghGERkgwgtAICUYQGiHBCEIjJBhBaIQEIwiNkGAEoRESjCA0QoIRhEZIMILQCAlGEBohwQhCIyQYQWiEBCMIjZBgBKEREowgNEKCEYRGSDCC0AgJRhAaIcEIQiMkGEFohAQjCI2QYAShERKMIDRCghGERkgwgtAICUYQGiHBCEIjJBhBaOT/ATsjThABByudAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">r12 &lt;-<span class="st"> </span><span class="cf">function</span>(x, i) {</a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="co">#want correlation of columns 1 and 2</span></a>
<a class="sourceLine" id="cb52-3" data-line-number="3"><span class="kw">cor</span>(x[i,<span class="dv">1</span>], x[i,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb52-4" data-line-number="4">}</a>
<a class="sourceLine" id="cb52-5" data-line-number="5">r34 &lt;-<span class="st"> </span><span class="cf">function</span>(x, i) {</a>
<a class="sourceLine" id="cb52-6" data-line-number="6"><span class="co">#want correlation of columns 1 and 2</span></a>
<a class="sourceLine" id="cb52-7" data-line-number="7"><span class="kw">cor</span>(x[i,<span class="dv">3</span>], x[i,<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb52-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb52-9" data-line-number="9">r35 &lt;-<span class="st"> </span><span class="cf">function</span>(x, i) {</a>
<a class="sourceLine" id="cb52-10" data-line-number="10"><span class="co">#want correlation of columns 1 and 2</span></a>
<a class="sourceLine" id="cb52-11" data-line-number="11"><span class="kw">cor</span>(x[i,<span class="dv">3</span>], x[i,<span class="dv">5</span>])</a>
<a class="sourceLine" id="cb52-12" data-line-number="12">}</a>
<a class="sourceLine" id="cb52-13" data-line-number="13">r45 &lt;-<span class="st"> </span><span class="cf">function</span>(x, i) {</a>
<a class="sourceLine" id="cb52-14" data-line-number="14"><span class="co">#want correlation of columns 1 and 2</span></a>
<a class="sourceLine" id="cb52-15" data-line-number="15"><span class="kw">cor</span>(x[i,<span class="dv">4</span>], x[i,<span class="dv">5</span>])</a>
<a class="sourceLine" id="cb52-16" data-line-number="16">}</a>
<a class="sourceLine" id="cb52-17" data-line-number="17"><span class="kw">library</span>(boot) <span class="co">#for boot function</span></a>
<a class="sourceLine" id="cb52-18" data-line-number="18">t12 &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> scor, <span class="dt">statistic =</span> r12, <span class="dt">R =</span> <span class="dv">2000</span>)<span class="op">$</span>t</a>
<a class="sourceLine" id="cb52-19" data-line-number="19">std12 &lt;-<span class="st"> </span><span class="kw">sd</span>(t12)</a>
<a class="sourceLine" id="cb52-20" data-line-number="20">t34 &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> scor, <span class="dt">statistic =</span> r34, <span class="dt">R =</span> <span class="dv">2000</span>)<span class="op">$</span>t</a>
<a class="sourceLine" id="cb52-21" data-line-number="21">std34 &lt;-<span class="st"> </span><span class="kw">sd</span>(t34)</a>
<a class="sourceLine" id="cb52-22" data-line-number="22">t35 &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> scor, <span class="dt">statistic =</span> r35, <span class="dt">R =</span> <span class="dv">2000</span>)<span class="op">$</span>t</a>
<a class="sourceLine" id="cb52-23" data-line-number="23">std35 &lt;-<span class="st"> </span><span class="kw">sd</span>(t35)</a>
<a class="sourceLine" id="cb52-24" data-line-number="24">t45 &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> scor, <span class="dt">statistic =</span> r45, <span class="dt">R =</span> <span class="dv">2000</span>)<span class="op">$</span>t</a>
<a class="sourceLine" id="cb52-25" data-line-number="25">std45 &lt;-<span class="st"> </span><span class="kw">sd</span>(t45)</a>
<a class="sourceLine" id="cb52-26" data-line-number="26"><span class="kw">print</span>(<span class="kw">c</span>(std12,std34,std35,std45))</a></code></pre></div>
<pre><code>## [1] 0.07670263 0.04961991 0.05999520 0.06972214</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(std12,std34,std35,std45)</a>
<a class="sourceLine" id="cb54-2" data-line-number="2"><span class="kw">colnames</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ρ^12&quot;</span>, <span class="st">&quot;ρ^34&quot;</span>, <span class="st">&quot;ρ^35&quot;</span>,<span class="st">&quot;ρ^45&quot;</span>)</a>
<a class="sourceLine" id="cb54-3" data-line-number="3"><span class="kw">kable</span>(df, <span class="dt">escape =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">position =</span> <span class="st">&quot;center&quot;</span>)</a></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
ρ^12
</th>
<th style="text-align:right;">
ρ^34
</th>
<th style="text-align:right;">
ρ^35
</th>
<th style="text-align:right;">
ρ^45
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.0767026
</td>
<td style="text-align:right;">
0.0496199
</td>
<td style="text-align:right;">
0.0599952
</td>
<td style="text-align:right;">
0.0697221
</td>
</tr>
</tbody>
</table>
<p>#####<strong>Conclusion 1.1:</strong>No matter looking at scatter plot or correlation matrix, we can see that the five scores are positively correlated. The correlation between mec and sta is the weakest, with the correlation coefficient of 0.3890993. The correlation between alg and ana is the strongest, with the correlation coefficient of 0.7108059.</p>
<p>#####<strong>Conclusion 1.2:</strong>The bootstrap estimates specified of the standard errors are 0.07670263,0.04961991,0.05999520 and 0.06972214.</p>
</div>
<div id="question-2-4" class="section level3">
<h3>Question 2</h3>
<blockquote>
<p>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and χ2(5) distributions (positive skewness).</p>
</blockquote>
</div>
<div id="answer-2-4" class="section level3">
<h3>Answer 2</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb55-2" data-line-number="2"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb55-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb55-4" data-line-number="4">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) {</a>
<a class="sourceLine" id="cb55-5" data-line-number="5">m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i] <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x[i]))<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb55-6" data-line-number="6">m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i] <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x[i]))<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb55-7" data-line-number="7"><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb55-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb55-9" data-line-number="9"></a>
<a class="sourceLine" id="cb55-10" data-line-number="10">cou.n &lt;-<span class="st"> </span>cou.b &lt;-<span class="st"> </span>cou.p &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb55-11" data-line-number="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) {</a>
<a class="sourceLine" id="cb55-12" data-line-number="12">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">50</span>)</a>
<a class="sourceLine" id="cb55-13" data-line-number="13">  true.sk &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb55-14" data-line-number="14">  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(x,<span class="dt">statistic =</span> sk,<span class="dt">R =</span> <span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb55-15" data-line-number="15">  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(boot.obj,<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb55-16" data-line-number="16">  ci.normal &lt;-<span class="st"> </span>ci<span class="op">$</span>normal</a>
<a class="sourceLine" id="cb55-17" data-line-number="17">  ci.basic &lt;-<span class="st"> </span>ci<span class="op">$</span>basic</a>
<a class="sourceLine" id="cb55-18" data-line-number="18">  ci.perc &lt;-<span class="st"> </span>ci<span class="op">$</span>percent</a>
<a class="sourceLine" id="cb55-19" data-line-number="19">  <span class="cf">if</span>(ci.normal[<span class="dv">2</span>] <span class="op">&lt;</span><span class="st"> </span>true.sk <span class="op">&amp;&amp;</span><span class="st"> </span>true.sk <span class="op">&lt;</span><span class="st"> </span>ci.normal[<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb55-20" data-line-number="20">  {cou.n &lt;-<span class="st"> </span>cou.n <span class="op">+</span><span class="st"> </span><span class="dv">1</span>}</a>
<a class="sourceLine" id="cb55-21" data-line-number="21">  <span class="cf">if</span>(ci.basic[<span class="dv">4</span>] <span class="op">&lt;</span><span class="st"> </span>true.sk <span class="op">&amp;&amp;</span><span class="st"> </span>true.sk <span class="op">&lt;</span><span class="st"> </span>ci.basic[<span class="dv">5</span>])</a>
<a class="sourceLine" id="cb55-22" data-line-number="22">  {cou.b &lt;-<span class="st"> </span>cou.b <span class="op">+</span><span class="st"> </span><span class="dv">1</span>}</a>
<a class="sourceLine" id="cb55-23" data-line-number="23">  <span class="cf">if</span>(ci.perc[<span class="dv">4</span>] <span class="op">&lt;</span><span class="st"> </span>true.sk <span class="op">&amp;&amp;</span><span class="st"> </span>true.sk <span class="op">&lt;</span><span class="st"> </span>ci.perc[<span class="dv">5</span>])</a>
<a class="sourceLine" id="cb55-24" data-line-number="24">  {cou.p &lt;-<span class="st"> </span>cou.p <span class="op">+</span><span class="st"> </span><span class="dv">1</span>}</a>
<a class="sourceLine" id="cb55-25" data-line-number="25">}</a>
<a class="sourceLine" id="cb55-26" data-line-number="26">normal.fre.n &lt;-<span class="st"> </span>cou.n <span class="op">/</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb55-27" data-line-number="27">normal.fre.b &lt;-<span class="st"> </span>cou.b <span class="op">/</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb55-28" data-line-number="28">normal.fre.p &lt;-<span class="st"> </span>cou.p <span class="op">/</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb55-29" data-line-number="29"></a>
<a class="sourceLine" id="cb55-30" data-line-number="30">cou.n &lt;-<span class="st"> </span>cou.b &lt;-<span class="st"> </span>cou.p &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb55-31" data-line-number="31"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) {</a>
<a class="sourceLine" id="cb55-32" data-line-number="32">  y &lt;-<span class="st"> </span><span class="kw">rchisq</span>(<span class="dv">50</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb55-33" data-line-number="33">  true.sk &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">8</span> <span class="op">/</span><span class="st"> </span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb55-34" data-line-number="34">  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(y,<span class="dt">statistic =</span> sk,<span class="dt">R =</span> <span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb55-35" data-line-number="35">  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(boot.obj,<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb55-36" data-line-number="36">  ci.normal &lt;-<span class="st"> </span>ci<span class="op">$</span>normal</a>
<a class="sourceLine" id="cb55-37" data-line-number="37">  ci.basic &lt;-<span class="st"> </span>ci<span class="op">$</span>basic</a>
<a class="sourceLine" id="cb55-38" data-line-number="38">  ci.perc &lt;-<span class="st"> </span>ci<span class="op">$</span>percent</a>
<a class="sourceLine" id="cb55-39" data-line-number="39">  <span class="cf">if</span>(ci.normal[<span class="dv">2</span>] <span class="op">&lt;</span><span class="st"> </span>true.sk <span class="op">&amp;&amp;</span><span class="st"> </span>true.sk <span class="op">&lt;</span><span class="st"> </span>ci.normal[<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb55-40" data-line-number="40">  {cou.n &lt;-<span class="st"> </span>cou.n <span class="op">+</span><span class="st"> </span><span class="dv">1</span>}</a>
<a class="sourceLine" id="cb55-41" data-line-number="41">  <span class="cf">if</span>(ci.basic[<span class="dv">4</span>] <span class="op">&lt;</span><span class="st"> </span>true.sk <span class="op">&amp;&amp;</span><span class="st"> </span>true.sk <span class="op">&lt;</span><span class="st"> </span>ci.basic[<span class="dv">5</span>])</a>
<a class="sourceLine" id="cb55-42" data-line-number="42">  {cou.b &lt;-<span class="st"> </span>cou.b <span class="op">+</span><span class="st"> </span><span class="dv">1</span>}</a>
<a class="sourceLine" id="cb55-43" data-line-number="43">  <span class="cf">if</span>(ci.perc[<span class="dv">4</span>] <span class="op">&lt;</span><span class="st"> </span>true.sk <span class="op">&amp;&amp;</span><span class="st"> </span>true.sk <span class="op">&lt;</span><span class="st"> </span>ci.perc[<span class="dv">5</span>])</a>
<a class="sourceLine" id="cb55-44" data-line-number="44">  {cou.p &lt;-<span class="st"> </span>cou.p <span class="op">+</span><span class="st"> </span><span class="dv">1</span>}</a>
<a class="sourceLine" id="cb55-45" data-line-number="45">}</a>
<a class="sourceLine" id="cb55-46" data-line-number="46">chisq.fre.n &lt;-<span class="st"> </span>cou.n <span class="op">/</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb55-47" data-line-number="47">chisq.fre.b &lt;-<span class="st"> </span>cou.b <span class="op">/</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb55-48" data-line-number="48">chisq.fre.p &lt;-<span class="st"> </span>cou.p <span class="op">/</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb55-49" data-line-number="49"></a>
<a class="sourceLine" id="cb55-50" data-line-number="50">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(normal.fre.n, chisq.fre.n),</a>
<a class="sourceLine" id="cb55-51" data-line-number="51">                 <span class="dt">y =</span> <span class="kw">c</span>(normal.fre.b, chisq.fre.b),</a>
<a class="sourceLine" id="cb55-52" data-line-number="52">                 <span class="dt">z =</span> <span class="kw">c</span>(normal.fre.p, chisq.fre.p))</a>
<a class="sourceLine" id="cb55-53" data-line-number="53"><span class="kw">colnames</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>)</a>
<a class="sourceLine" id="cb55-54" data-line-number="54"><span class="kw">rownames</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;N(0,1)&quot;</span>, <span class="st">&quot;χ2(5)&quot;</span>)</a>
<a class="sourceLine" id="cb55-55" data-line-number="55"><span class="kw">kable</span>(df, <span class="dt">escape =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">row_spec</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">bold =</span> T) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">position =</span> <span class="st">&quot;center&quot;</span>)</a></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
norm
</th>
<th style="text-align:right;">
basic
</th>
<th style="text-align:right;">
perc
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
N(0,1)
</td>
<td style="text-align:right;font-weight: bold;">
0.91
</td>
<td style="text-align:right;font-weight: bold;">
0.92
</td>
<td style="text-align:right;font-weight: bold;">
0.96
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
χ2(5)
</td>
<td style="text-align:right;font-weight: bold;">
0.79
</td>
<td style="text-align:right;font-weight: bold;">
0.76
</td>
<td style="text-align:right;font-weight: bold;">
0.77
</td>
</tr>
</tbody>
</table>
<p>#####<strong>Conclusion 2:</strong>From the table,we can see the coverage rates for normal populations is 0.92,0.91 and 0.96,while the coverage rates for χ2(5) is 0.76,0.79 and 0.77.It’s obvious that the coverage rates of positive skewness is lower than the coverage rates of skewness 0.</p>
</div>
<div id="hw7" class="section level3">
<h3>HW7</h3>
</div>
<div id="question-1-5" class="section level3">
<h3>Question 1</h3>
<blockquote>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</blockquote>
</div>
<div id="answer-1-5" class="section level3">
<h3>Answer 1</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb56-2" data-line-number="2"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb56-3" data-line-number="3"></a>
<a class="sourceLine" id="cb56-4" data-line-number="4"><span class="kw">data</span>(scor,<span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</a>
<a class="sourceLine" id="cb56-5" data-line-number="5">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb56-6" data-line-number="6">lamda &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(scor))<span class="op">$</span>values </a>
<a class="sourceLine" id="cb56-7" data-line-number="7">theta.hat &lt;-<span class="st"> </span>lamda[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lamda) </a>
<a class="sourceLine" id="cb56-8" data-line-number="8">theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n) </a>
<a class="sourceLine" id="cb56-9" data-line-number="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</a>
<a class="sourceLine" id="cb56-10" data-line-number="10">{lamda.jack &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(scor[<span class="op">-</span>i,]))<span class="op">$</span>values </a>
<a class="sourceLine" id="cb56-11" data-line-number="11">theta.jack[i] &lt;-<span class="st"> </span>lamda.jack[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lamda.jack) </a>
<a class="sourceLine" id="cb56-12" data-line-number="12">}</a>
<a class="sourceLine" id="cb56-13" data-line-number="13">bias.jack &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta.jack) <span class="op">-</span><span class="st"> </span>theta.hat) <span class="co">#the jackknife estimate of bias</span></a>
<a class="sourceLine" id="cb56-14" data-line-number="14">se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>((theta.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta.jack)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))  <span class="co">#the jackknife estimate of standard error </span></a>
<a class="sourceLine" id="cb56-15" data-line-number="15"></a>
<a class="sourceLine" id="cb56-16" data-line-number="16">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(theta.hat,bias.jack,se.jack)</a>
<a class="sourceLine" id="cb56-17" data-line-number="17"><span class="kw">colnames</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;theta.hat&quot;</span>, <span class="st">&quot;bias&quot;</span>, <span class="st">&quot;standard error&quot;</span>)</a>
<a class="sourceLine" id="cb56-18" data-line-number="18"><span class="kw">kable</span>(df, <span class="dt">escape =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">position =</span> <span class="st">&quot;center&quot;</span>)</a></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
theta.hat
</th>
<th style="text-align:right;">
bias
</th>
<th style="text-align:right;">
standard error
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.619115
</td>
<td style="text-align:right;">
0.0010691
</td>
<td style="text-align:right;">
0.0495523
</td>
</tr>
</tbody>
</table>
<p>#####<strong>Conclusion 1:</strong>As we can see in the table,the jackknife estimates of bias and standard error are 0.0010691 and 0.0495523 respectively.</p>
</div>
<div id="question-2-5" class="section level3">
<h3>Question 2</h3>
<blockquote>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^{2}\)</span>?</p>
</blockquote>
</div>
<div id="answer-2-5" class="section level3">
<h3>Answer 2</h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="kw">library</span>(DAAG)</a>
<a class="sourceLine" id="cb57-2" data-line-number="2"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb57-3" data-line-number="3"><span class="kw">attach</span>(ironslag)</a>
<a class="sourceLine" id="cb57-4" data-line-number="4"></a>
<a class="sourceLine" id="cb57-5" data-line-number="5">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></a>
<a class="sourceLine" id="cb57-6" data-line-number="6">e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb57-7" data-line-number="7"></a>
<a class="sourceLine" id="cb57-8" data-line-number="8"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb57-9" data-line-number="9">y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb57-10" data-line-number="10">x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb57-11" data-line-number="11"></a>
<a class="sourceLine" id="cb57-12" data-line-number="12">J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb57-13" data-line-number="13">yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb57-14" data-line-number="14">e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb57-15" data-line-number="15"></a>
<a class="sourceLine" id="cb57-16" data-line-number="16">J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb57-17" data-line-number="17">yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span></a>
<a class="sourceLine" id="cb57-18" data-line-number="18">J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb57-19" data-line-number="19">e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb57-20" data-line-number="20"></a>
<a class="sourceLine" id="cb57-21" data-line-number="21">J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb57-22" data-line-number="22">logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb57-23" data-line-number="23">yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb57-24" data-line-number="24">e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</a>
<a class="sourceLine" id="cb57-25" data-line-number="25"></a>
<a class="sourceLine" id="cb57-26" data-line-number="26">J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb57-27" data-line-number="27">yhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span></a>
<a class="sourceLine" id="cb57-28" data-line-number="28">J4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb57-29" data-line-number="29">e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</a>
<a class="sourceLine" id="cb57-30" data-line-number="30">}</a>
<a class="sourceLine" id="cb57-31" data-line-number="31"></a>
<a class="sourceLine" id="cb57-32" data-line-number="32">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb57-33" data-line-number="33"><span class="kw">colnames</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;mean(e1^2)&quot;</span>, <span class="st">&quot;mean(e2^2)&quot;</span>, <span class="st">&quot;mean(e3^2)&quot;</span>,<span class="st">&quot;mean(e4^2)&quot;</span>)</a>
<a class="sourceLine" id="cb57-34" data-line-number="34"><span class="kw">kable</span>(df, <span class="dt">escape =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">position =</span> <span class="st">&quot;center&quot;</span>)</a></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
mean(e1^2)
</th>
<th style="text-align:right;">
mean(e2^2)
</th>
<th style="text-align:right;">
mean(e3^2)
</th>
<th style="text-align:right;">
mean(e4^2)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
19.55644
</td>
<td style="text-align:right;">
17.85248
</td>
<td style="text-align:right;">
18.44188
</td>
<td style="text-align:right;">
18.17756
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="fl">.1</span>) <span class="co">#sequence for plotting fits</span></a>
<a class="sourceLine" id="cb58-2" data-line-number="2"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb58-3" data-line-number="3"></a>
<a class="sourceLine" id="cb58-4" data-line-number="4">L1 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb58-5" data-line-number="5"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Linear&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb58-6" data-line-number="6">yhat1 &lt;-<span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a</a>
<a class="sourceLine" id="cb58-7" data-line-number="7"><span class="kw">lines</span>(a, yhat1, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1">L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb59-2" data-line-number="2"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Quadratic&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb59-3" data-line-number="3">yhat2 &lt;-<span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb59-4" data-line-number="4"><span class="kw">lines</span>(a, yhat2, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1">L3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb60-2" data-line-number="2"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Exponential&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb60-3" data-line-number="3">logyhat3 &lt;-<span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a</a>
<a class="sourceLine" id="cb60-4" data-line-number="4">yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb60-5" data-line-number="5"><span class="kw">lines</span>(a, yhat3, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1">L4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(chemical))</a>
<a class="sourceLine" id="cb61-2" data-line-number="2"><span class="kw">plot</span>(<span class="kw">log</span>(chemical), <span class="kw">log</span>(magnetic), <span class="dt">main=</span><span class="st">&quot;Log-Log&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb61-3" data-line-number="3">logyhat4 &lt;-<span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(a)</a>
<a class="sourceLine" id="cb61-4" data-line-number="4"><span class="kw">lines</span>(<span class="kw">log</span>(a), logyhat4, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">adj1 &lt;-<span class="st"> </span><span class="kw">summary</span>(L1)<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb62-2" data-line-number="2">adj2 &lt;-<span class="st"> </span><span class="kw">summary</span>(L2)<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb62-3" data-line-number="3">adj3 &lt;-<span class="st"> </span><span class="kw">summary</span>(L3)<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb62-4" data-line-number="4">adj4 &lt;-<span class="st"> </span><span class="kw">summary</span>(L4)<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb62-5" data-line-number="5"></a>
<a class="sourceLine" id="cb62-6" data-line-number="6">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(adj1,adj2,adj3,adj4)</a>
<a class="sourceLine" id="cb62-7" data-line-number="7"><span class="kw">colnames</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;adj1&quot;</span>, <span class="st">&quot;adj2&quot;</span>, <span class="st">&quot;adj3&quot;</span>,<span class="st">&quot;adj4&quot;</span>)</a>
<a class="sourceLine" id="cb62-8" data-line-number="8"><span class="kw">kable</span>(df, <span class="dt">escape =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">position =</span> <span class="st">&quot;center&quot;</span>)</a></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
adj1
</th>
<th style="text-align:right;">
adj2
</th>
<th style="text-align:right;">
adj3
</th>
<th style="text-align:right;">
adj4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.5281545
</td>
<td style="text-align:right;">
0.5768151
</td>
<td style="text-align:right;">
0.5280556
</td>
<td style="text-align:right;">
0.4870624
</td>
</tr>
</tbody>
</table>
<p>#####<strong>Conclusion 2.1:</strong>It’s clear to see that Model 2, the quadratic model,is selected by the cross validation procedure.</p>
<p>#####<strong>Conclusion 2.1:</strong>According to maximum adjusted R^2，Model 2 is also selected.</p>
</div>
<div id="hw8" class="section level3">
<h3>HW8</h3>
</div>
<div id="question-1-6" class="section level3">
<h3>Question 1</h3>
<blockquote>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</blockquote>
</div>
<div id="answer-1-6" class="section level3">
<h3>Answer 1</h3>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1">n1 &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb63-2" data-line-number="2">n2 &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb63-3" data-line-number="3">mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb63-4" data-line-number="4">sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb63-5" data-line-number="5">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb63-6" data-line-number="6"></a>
<a class="sourceLine" id="cb63-7" data-line-number="7"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb63-8" data-line-number="8">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</a>
<a class="sourceLine" id="cb63-9" data-line-number="9">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</a>
<a class="sourceLine" id="cb63-10" data-line-number="10"></a>
<a class="sourceLine" id="cb63-11" data-line-number="11"><span class="co"># compute the maximum numebers of extreme points m1 and m2</span></a>
<a class="sourceLine" id="cb63-12" data-line-number="12"><span class="kw">log</span>(.<span class="dv">025</span>) <span class="op">/</span><span class="st"> </span><span class="kw">log</span>(n1 <span class="op">/</span><span class="st"> </span>(n1 <span class="op">+</span><span class="st"> </span>n2))</a></code></pre></div>
<pre><code>## [1] 4.025883</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1"><span class="kw">log</span>(.<span class="dv">025</span>) <span class="op">/</span><span class="st"> </span><span class="kw">log</span>(n2 <span class="op">/</span><span class="st"> </span>(n1 <span class="op">+</span><span class="st"> </span>n2))</a></code></pre></div>
<pre><code>## [1] 7.221406</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1">m1 &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb67-2" data-line-number="2">m2 &lt;-<span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb67-3" data-line-number="3"></a>
<a class="sourceLine" id="cb67-4" data-line-number="4"><span class="co"># original statistic</span></a>
<a class="sourceLine" id="cb67-5" data-line-number="5">count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb67-6" data-line-number="6">  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb67-7" data-line-number="7">  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb67-8" data-line-number="8">  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb67-9" data-line-number="9">  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb67-10" data-line-number="10">  <span class="kw">return</span>(<span class="kw">as.integer</span>((outx <span class="op">&gt;</span><span class="st"> </span>m1) <span class="op">|</span><span class="st"> </span>(outy <span class="op">&gt;</span><span class="st"> </span>m2)))</a>
<a class="sourceLine" id="cb67-11" data-line-number="11">}</a>
<a class="sourceLine" id="cb67-12" data-line-number="12"></a>
<a class="sourceLine" id="cb67-13" data-line-number="13">R &lt;-<span class="st"> </span><span class="dv">9999</span></a>
<a class="sourceLine" id="cb67-14" data-line-number="14">z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</a>
<a class="sourceLine" id="cb67-15" data-line-number="15">K &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</a>
<a class="sourceLine" id="cb67-16" data-line-number="16">reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)</a>
<a class="sourceLine" id="cb67-17" data-line-number="17">t0 &lt;-<span class="st"> </span><span class="kw">count5test</span>(x,y)</a>
<a class="sourceLine" id="cb67-18" data-line-number="18"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</a>
<a class="sourceLine" id="cb67-19" data-line-number="19">  k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> n1, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb67-20" data-line-number="20">  x1 &lt;-<span class="st"> </span>z[k]</a>
<a class="sourceLine" id="cb67-21" data-line-number="21">  y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb67-22" data-line-number="22">  X &lt;-<span class="st"> </span>x1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x1)</a>
<a class="sourceLine" id="cb67-23" data-line-number="23">  Y &lt;-<span class="st"> </span>y1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y1)</a>
<a class="sourceLine" id="cb67-24" data-line-number="24">  reps[i] &lt;-<span class="st"> </span><span class="kw">count5test</span>(x1, y1)</a>
<a class="sourceLine" id="cb67-25" data-line-number="25">}</a>
<a class="sourceLine" id="cb67-26" data-line-number="26"></a>
<a class="sourceLine" id="cb67-27" data-line-number="27"><span class="co"># compute alphahat</span></a>
<a class="sourceLine" id="cb67-28" data-line-number="28">alphahat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(t0, reps) <span class="op">&gt;</span><span class="st"> </span>t0)</a>
<a class="sourceLine" id="cb67-29" data-line-number="29"><span class="kw">print</span>(alphahat)</a></code></pre></div>
<pre><code>## [1] 0.0431</code></pre>
</div>
<div id="question-2-6" class="section level3">
<h3>Question 2</h3>
<blockquote>
<p>Power comparison (distance correlation test versus ball covariance test) Model 1: <span class="math display">\[Y=X / 4+e\]</span> Model 2: <span class="math display">\[Y=X / 4 \times e\]</span> <span class="math inline">\(X \sim N\left(0_{2}, l_{2}\right), e \sim N\left(0_{2}, l_{2}\right)\)</span>,<span class="math inline">\(X\)</span> and <span class="math inline">\(e\)</span> are independent.</p>
</blockquote>
</div>
<div id="answer-2-6" class="section level3">
<h3>Answer 2</h3>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb69-2" data-line-number="2"><span class="kw">library</span>(mvtnorm)</a>
<a class="sourceLine" id="cb69-3" data-line-number="3"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb69-4" data-line-number="4"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb69-5" data-line-number="5"><span class="co"># distance correlation function</span></a>
<a class="sourceLine" id="cb69-6" data-line-number="6">dCov &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb69-7" data-line-number="7">  x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(x); y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(y)</a>
<a class="sourceLine" id="cb69-8" data-line-number="8">  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x); m &lt;-<span class="st"> </span><span class="kw">nrow</span>(y)</a>
<a class="sourceLine" id="cb69-9" data-line-number="9">  <span class="cf">if</span> (n <span class="op">!=</span><span class="st"> </span>m <span class="op">||</span><span class="st"> </span>n <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;Sample sizes must agree&quot;</span>)</a>
<a class="sourceLine" id="cb69-10" data-line-number="10">  <span class="cf">if</span> (<span class="op">!</span><span class="st"> </span>(<span class="kw">all</span>(<span class="kw">is.finite</span>(<span class="kw">c</span>(x, y)))))</a>
<a class="sourceLine" id="cb69-11" data-line-number="11">  <span class="kw">stop</span>(<span class="st">&quot;Data contains missing or infinite values&quot;</span>)</a>
<a class="sourceLine" id="cb69-12" data-line-number="12">  Akl &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb69-13" data-line-number="13">  d &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">dist</span>(x))</a>
<a class="sourceLine" id="cb69-14" data-line-number="14">  m &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(d); M &lt;-<span class="st"> </span><span class="kw">mean</span>(d)</a>
<a class="sourceLine" id="cb69-15" data-line-number="15">  a &lt;-<span class="st"> </span><span class="kw">sweep</span>(d, <span class="dv">1</span>, m); b &lt;-<span class="st"> </span><span class="kw">sweep</span>(a, <span class="dv">2</span>, m)</a>
<a class="sourceLine" id="cb69-16" data-line-number="16">  b <span class="op">+</span><span class="st"> </span>M</a>
<a class="sourceLine" id="cb69-17" data-line-number="17">  }</a>
<a class="sourceLine" id="cb69-18" data-line-number="18">A&lt;-<span class="st"> </span><span class="kw">Akl</span>(x); B &lt;-<span class="st"> </span><span class="kw">Akl</span>(y)</a>
<a class="sourceLine" id="cb69-19" data-line-number="19"><span class="kw">sqrt</span>(<span class="kw">mean</span>(A <span class="op">*</span><span class="st"> </span>B))</a>
<a class="sourceLine" id="cb69-20" data-line-number="20">}</a>
<a class="sourceLine" id="cb69-21" data-line-number="21">ndCov2 &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, dims) {</a>
<a class="sourceLine" id="cb69-22" data-line-number="22"><span class="co">#dims contains dimensions of x and y</span></a>
<a class="sourceLine" id="cb69-23" data-line-number="23">p &lt;-<span class="st"> </span>dims[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb69-24" data-line-number="24">q &lt;-<span class="st"> </span>dims[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb69-25" data-line-number="25">d &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span>q</a>
<a class="sourceLine" id="cb69-26" data-line-number="26">x &lt;-<span class="st"> </span>z[ , <span class="dv">1</span><span class="op">:</span>p] <span class="co">#leave x as is</span></a>
<a class="sourceLine" id="cb69-27" data-line-number="27">y &lt;-<span class="st"> </span>z[ix, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>p)] <span class="co">#permute rows of y</span></a>
<a class="sourceLine" id="cb69-28" data-line-number="28"><span class="kw">return</span>(<span class="kw">nrow</span>(z) <span class="op">*</span><span class="st"> </span><span class="kw">dCov</span>(x, y)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb69-29" data-line-number="29">}</a>
<a class="sourceLine" id="cb69-30" data-line-number="30"><span class="co"># generate sample</span></a>
<a class="sourceLine" id="cb69-31" data-line-number="31">n&lt;-<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">10</span>,<span class="dt">to=</span><span class="dv">100</span>,<span class="dt">by=</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb69-32" data-line-number="32"><span class="co"># loop</span></a>
<a class="sourceLine" id="cb69-33" data-line-number="33">k&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb69-34" data-line-number="34"><span class="co"># significant level</span></a>
<a class="sourceLine" id="cb69-35" data-line-number="35">alpha&lt;-<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb69-36" data-line-number="36">pow_dCor_Model1&lt;-pow_ball_Model1&lt;-pow_dCor_Model2&lt;-pow_ball_Model2&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(n))</a>
<a class="sourceLine" id="cb69-37" data-line-number="37"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</a>
<a class="sourceLine" id="cb69-38" data-line-number="38"></a>
<a class="sourceLine" id="cb69-39" data-line-number="39">  <span class="co">#storage of temp data</span></a>
<a class="sourceLine" id="cb69-40" data-line-number="40">  p_ball1&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb69-41" data-line-number="41">  dcor1&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb69-42" data-line-number="42">  p_ball2&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb69-43" data-line-number="43">  dcor2&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb69-44" data-line-number="44">  dcor1&lt;-dcor2&lt;-p_ball1&lt;-p_ball2&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb69-45" data-line-number="45">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) {</a>
<a class="sourceLine" id="cb69-46" data-line-number="46">    <span class="kw">set.seed</span>(i)</a>
<a class="sourceLine" id="cb69-47" data-line-number="47">    <span class="co"># the function &quot;rmvnorm&quot; is used to </span></a>
<a class="sourceLine" id="cb69-48" data-line-number="48">    <span class="co"># generate the multidimensional normal data</span></a>
<a class="sourceLine" id="cb69-49" data-line-number="49">    X&lt;-<span class="kw">rmvnorm</span>(n[j],<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="kw">diag</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb69-50" data-line-number="50">    err&lt;-<span class="kw">rmvnorm</span>(n[j],<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="kw">diag</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb69-51" data-line-number="51">    Y1&lt;-(X<span class="op">/</span><span class="dv">4</span>)<span class="op">+</span>err</a>
<a class="sourceLine" id="cb69-52" data-line-number="52">    Y2&lt;-(X<span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>err</a>
<a class="sourceLine" id="cb69-53" data-line-number="53">    Z1&lt;-<span class="kw">cbind</span>(X,Y1)</a>
<a class="sourceLine" id="cb69-54" data-line-number="54">    Z2&lt;-<span class="kw">cbind</span>(X,Y2)</a>
<a class="sourceLine" id="cb69-55" data-line-number="55">    t1&lt;-<span class="kw">bcov.test</span>(X,Y2,<span class="dt">R=</span><span class="dv">99</span>)</a>
<a class="sourceLine" id="cb69-56" data-line-number="56">    p_ball1[i]&lt;-t1<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb69-57" data-line-number="57">    boot.obj1&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>Z1,<span class="dt">statistic=</span>ndCov2,<span class="dt">R=</span><span class="dv">99</span>,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">dims=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb69-58" data-line-number="58">    temp1&lt;-<span class="kw">c</span>(boot.obj1<span class="op">$</span>t0, boot.obj1<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb69-59" data-line-number="59">    dcor1[i]&lt;-<span class="kw">mean</span>(temp1<span class="op">&gt;=</span>temp1[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb69-60" data-line-number="60">    </a>
<a class="sourceLine" id="cb69-61" data-line-number="61">    t2&lt;-<span class="kw">bcov.test</span>(X,Y2,<span class="dt">R=</span><span class="dv">99</span>)</a>
<a class="sourceLine" id="cb69-62" data-line-number="62">    p_ball2[i]&lt;-t2<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb69-63" data-line-number="63">    boot.obj2&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>Z2,<span class="dt">statistic=</span>ndCov2,<span class="dt">R=</span><span class="dv">99</span>,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">dims=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb69-64" data-line-number="64">    temp2&lt;-<span class="kw">c</span>(boot.obj2<span class="op">$</span>t0, boot.obj2<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb69-65" data-line-number="65">    dcor2[i]&lt;-<span class="kw">mean</span>(temp2<span class="op">&gt;=</span>temp2[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb69-66" data-line-number="66">    }</a>
<a class="sourceLine" id="cb69-67" data-line-number="67">  pow_dCor_Model1[j]&lt;-<span class="kw">mean</span>(dcor1<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb69-68" data-line-number="68">  pow_ball_Model1[j]&lt;-<span class="kw">mean</span>(p_ball1<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb69-69" data-line-number="69">  pow_dCor_Model2[j]&lt;-<span class="kw">mean</span>(dcor2<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb69-70" data-line-number="70">  pow_ball_Model2[j]&lt;-<span class="kw">mean</span>(p_ball2<span class="op">&lt;</span>alpha)  </a>
<a class="sourceLine" id="cb69-71" data-line-number="71">}</a>
<a class="sourceLine" id="cb69-72" data-line-number="72">dat&lt;-<span class="kw">data.frame</span>(pow_dCor_Model1,pow_ball_Model1,pow_dCor_Model2,pow_ball_Model2)</a>
<a class="sourceLine" id="cb69-73" data-line-number="73"><span class="co"># the red one is distance correlation test and the blue one is ballcovariance test</span></a>
<a class="sourceLine" id="cb69-74" data-line-number="74"><span class="kw">ggplot</span>(dat,<span class="kw">aes</span>(n))<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">y=</span>pow_dCor_Model1,<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">y=</span>pow_dCor_Model1,<span class="dt">colour=</span><span class="st">&quot;yellow&quot;</span>)<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">y=</span>pow_ball_Model1,<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">y=</span>pow_ball_Model1,<span class="dt">colour=</span><span class="st">&quot;green&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1"><span class="kw">ggplot</span>(dat,<span class="kw">aes</span>(n))<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">y=</span>pow_dCor_Model2,<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">y=</span>pow_dCor_Model2,<span class="dt">colour=</span><span class="st">&quot;yellow&quot;</span>)<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">y=</span>pow_ball_Model2,<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">y=</span>pow_ball_Model2,<span class="dt">colour=</span><span class="st">&quot;green&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="conclusion-2the-first-plot-is-the-power-comparison-of-model-1and-the-second-plot-is-the-power-comparison-of-model-2.the-yellow-lines-represent-the-powers-of-distance-correlation-testand-the-green-lines-represent-the-powers-of-ball-covariance-test.obviouslythe-ball-covariance-test-is-more-powerful-than-the-distance-correlation-test." class="section level5">
<h5><strong>Conclusion 2:</strong>The first plot is the power comparison of Model 1,and the second plot is the power comparison of Model 2.The yellow lines represent the powers of distance correlation test,and the green lines represent the powers of ball covariance test.Obviously,the ball covariance test is more powerful than the distance correlation test.</h5>
</div>
</div>
<div id="hw9" class="section level3">
<h3>HW9</h3>
</div>
<div id="question-4" class="section level3">
<h3>Question</h3>
<blockquote>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</blockquote>
</div>
<div id="answer-4" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb71-2" data-line-number="2"><span class="kw">library</span>(GeneralizedHyperbolic)</a>
<a class="sourceLine" id="cb71-3" data-line-number="3">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma,x0,N) {</a>
<a class="sourceLine" id="cb71-4" data-line-number="4">x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb71-5" data-line-number="5">x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb71-6" data-line-number="6">u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb71-7" data-line-number="7">k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb71-8" data-line-number="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb71-9" data-line-number="9">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb71-10" data-line-number="10"><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">abs</span>(y))){</a>
<a class="sourceLine" id="cb71-11" data-line-number="11">x[i] &lt;-<span class="st"> </span>y </a>
<a class="sourceLine" id="cb71-12" data-line-number="12">k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>}</a>
<a class="sourceLine" id="cb71-13" data-line-number="13"><span class="cf">else</span> {</a>
<a class="sourceLine" id="cb71-14" data-line-number="14">x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb71-15" data-line-number="15"></a>
<a class="sourceLine" id="cb71-16" data-line-number="16">} }</a>
<a class="sourceLine" id="cb71-17" data-line-number="17"><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb71-18" data-line-number="18">}</a>
<a class="sourceLine" id="cb71-19" data-line-number="19"></a>
<a class="sourceLine" id="cb71-20" data-line-number="20"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb71-21" data-line-number="21">N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb71-22" data-line-number="22">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb71-23" data-line-number="23">x0 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb71-24" data-line-number="24">rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N)</a>
<a class="sourceLine" id="cb71-25" data-line-number="25">rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N)</a>
<a class="sourceLine" id="cb71-26" data-line-number="26">rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N)</a>
<a class="sourceLine" id="cb71-27" data-line-number="27">rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N)</a>
<a class="sourceLine" id="cb71-28" data-line-number="28"></a>
<a class="sourceLine" id="cb71-29" data-line-number="29">x1 &lt;-<span class="st"> </span>rw1<span class="op">$</span>x</a>
<a class="sourceLine" id="cb71-30" data-line-number="30">x2 &lt;-<span class="st"> </span>rw2<span class="op">$</span>x</a>
<a class="sourceLine" id="cb71-31" data-line-number="31">x3 &lt;-<span class="st"> </span>rw3<span class="op">$</span>x</a>
<a class="sourceLine" id="cb71-32" data-line-number="32">x4 &lt;-<span class="st"> </span>rw4<span class="op">$</span>x</a>
<a class="sourceLine" id="cb71-33" data-line-number="33">hh &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">qskewlap</span>(<span class="fl">0.025</span>),<span class="kw">qskewlap</span>(<span class="fl">0.975</span>))</a>
<a class="sourceLine" id="cb71-34" data-line-number="34"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb71-35" data-line-number="35">index &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb71-36" data-line-number="36"><span class="kw">plot</span>(index, x1, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;σ=0.05&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x1&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>) )</a>
<a class="sourceLine" id="cb71-37" data-line-number="37"><span class="kw">abline</span>(<span class="dt">h=</span>hh)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1"><span class="kw">plot</span>(index, x2, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;σ=0.5&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x2&quot;</span>)</a>
<a class="sourceLine" id="cb72-2" data-line-number="2"><span class="kw">abline</span>(<span class="dt">h=</span>hh)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1"><span class="kw">plot</span>(index, x3, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;σ=2&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x3&quot;</span>)</a>
<a class="sourceLine" id="cb73-2" data-line-number="2"><span class="kw">abline</span>(<span class="dt">h=</span>hh)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1"><span class="kw">plot</span>(index, x4, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;σ=16&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x4&quot;</span>)</a>
<a class="sourceLine" id="cb74-2" data-line-number="2"><span class="kw">abline</span>(<span class="dt">h=</span>hh)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(rw1<span class="op">$</span>k <span class="op">/</span><span class="st"> </span>N, rw2<span class="op">$</span>k <span class="op">/</span><span class="st"> </span>N, rw3<span class="op">$</span>k <span class="op">/</span><span class="st"> </span>N, rw4<span class="op">$</span>k <span class="op">/</span><span class="st"> </span>N) <span class="co">#acceptance rates</span></a>
<a class="sourceLine" id="cb75-2" data-line-number="2"><span class="kw">colnames</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;σ=0.05&quot;</span>,<span class="st">&quot;σ=0.5&quot;</span>,<span class="st">&quot;σ=2&quot;</span>,<span class="st">&quot;σ=16&quot;</span>)</a>
<a class="sourceLine" id="cb75-3" data-line-number="3"><span class="kw">kable</span>(df, <span class="dt">escape =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,<span class="dt">position =</span> <span class="st">&quot;center&quot;</span>)</a></code></pre></div>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
σ=0.05
</th>
<th style="text-align:right;">
σ=0.5
</th>
<th style="text-align:right;">
σ=2
</th>
<th style="text-align:right;">
σ=16
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.981
</td>
<td style="text-align:right;">
0.8275
</td>
<td style="text-align:right;">
0.512
</td>
<td style="text-align:right;">
0.1
</td>
</tr>
</tbody>
</table>
<div id="conclusionthe-chains-generated-are-shown-as-the-above-graphs-when-different-variances-are-used.we-know-that-the-rejection-rates-should-be-in-the-range-0.15-0.5which-means-the-acceptance-rates-should-be-in-the-range-0.50.85.from-the-resultsi-conclude-that-when-σ0.5-and-σ2the-chains-satisfy-the-required-range." class="section level5">
<h5><strong>Conclusion:</strong>The chains generated are shown as the above graphs when different variances are used.We know that the rejection rates should be in the range [0.15, 0.5],which means the acceptance rates should be in the range [0.5,0.85].From the results,I conclude that when σ=0.5 and σ=2,the chains satisfy the required range.</h5>
</div>
</div>
<div id="hw10" class="section level3">
<h3>HW10</h3>
</div>
<div id="question-1-7" class="section level3">
<h3>Question 1</h3>
<blockquote>
<p>The natural logarithm and exponential functions are inverses of each other, so that mathematically log(exp x) = exp(log x) = x. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality? (See all.equal.)</p>
</blockquote>
</div>
<div id="answer-1-7" class="section level3">
<h3>Answer 1</h3>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb76-2" data-line-number="2">b &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">log</span>(<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb76-3" data-line-number="3">a <span class="op">==</span><span class="st"> </span>b</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(a,b))</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1"><span class="kw">print</span>(a<span class="op">-</span>b)</a></code></pre></div>
<pre><code>## [1] -1.776357e-15</code></pre>
<div id="conclusion-1by-trying-x10we-can-see-that-logexp10-is-not-absolutely-equal-to-explog10.the-absolute-value-of-the-difference-between-logexp10-and-explog10-is-about-1.776357e-15which-is-much-smaller-than-the-default-tolerance1.490116e-08so-the-two-values-are-considered-as-near-equality-computationally." class="section level5">
<h5><strong>Conclusion 1:</strong>By trying x=10,we can see that log(exp(10)) is not absolutely equal to exp(log(10)).The absolute value of the difference between log(exp(10)) and exp(log(10)) is about 1.776357e-15,which is much smaller than the default tolerance=1.490116e-08,so the two values are considered as near equality computationally.</h5>
</div>
</div>
<div id="question-2-7" class="section level3">
<h3>Question 2</h3>
<blockquote>
<p>Write a function to solve the equation<br />
<span class="math display">\[ \frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)} \Gamma\left(\frac{k-1}{2}\right)} \int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u = \frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k} \Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u  \]</span> for a, where <span class="math display">\[c_{k}=\sqrt{\frac{a^{2} k}{k+1-a^{2}}} \]</span> Compare the solutions with the points A(k) in Exercise 11.4.</p>
</blockquote>
</div>
<div id="answer-2-7" class="section level3">
<h3>Answer 2</h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1">f &lt;-<span class="st"> </span><span class="cf">function</span>(a,k) <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k)</a>
<a class="sourceLine" id="cb82-2" data-line-number="2">k &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb82-3" data-line-number="3">g &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">f</span>(x,k<span class="dv">-1</span>) <span class="op">-</span><span class="st"> </span><span class="kw">f</span>(x,k)</a>
<a class="sourceLine" id="cb82-4" data-line-number="4"></a>
<a class="sourceLine" id="cb82-5" data-line-number="5">a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">sqrt</span>(k),.<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb82-6" data-line-number="6"><span class="kw">plot</span>(a,<span class="kw">g</span>(a),<span class="dt">type =</span> <span class="st">'l'</span>)</a>
<a class="sourceLine" id="cb82-7" data-line-number="7"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1"><span class="kw">uniroot</span>(g,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>))<span class="op">$</span>root</a></code></pre></div>
<pre><code>## [1] 1.730899</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1">f1 &lt;-<span class="st"> </span><span class="cf">function</span>(k) <span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(pi<span class="op">*</span>k)<span class="op">*</span><span class="kw">exp</span>(<span class="kw">lgamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb85-2" data-line-number="2">ck &lt;-<span class="st"> </span><span class="cf">function</span>(a,k) <span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb85-3" data-line-number="3">g2 &lt;-<span class="st"> </span><span class="cf">function</span>(u,k) (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb85-4" data-line-number="4">k &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb85-5" data-line-number="5"></a>
<a class="sourceLine" id="cb85-6" data-line-number="6">fun &lt;-<span class="st"> </span><span class="cf">function</span>(a) <span class="kw">f1</span>(k)<span class="op">*</span><span class="kw">integrate</span>(<span class="cf">function</span>(u) {<span class="kw">g2</span>(u,k)}, <span class="dv">0</span>, <span class="kw">ck</span>(a,k))<span class="op">$</span>value <span class="op">-</span><span class="st"> </span><span class="kw">f1</span>(k<span class="dv">-1</span>)<span class="op">*</span><span class="kw">integrate</span>(<span class="cf">function</span>(u) {<span class="kw">g2</span>(u,k<span class="dv">-1</span>)}, <span class="dv">0</span>, <span class="kw">ck</span>(a,k<span class="dv">-1</span>))<span class="op">$</span>value </a>
<a class="sourceLine" id="cb85-7" data-line-number="7"><span class="kw">uniroot</span>(fun,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>))<span class="op">$</span>root</a></code></pre></div>
<pre><code>## [1] 1.730899</code></pre>
<div id="conclusion-2from-the-graph-of-the-function-in-11.4we-can-guess-that-the-root-is-in-range-15.using-the-uniroot-functioni-get-the-same-answer-1.730899-in-11.4-and-11.5." class="section level5">
<h5><strong>Conclusion 2:</strong>From the graph of the function in 11.4,we can guess that the root is in range [1,5].Using the uniroot function,I get the same answer 1.730899 in 11.4 and 11.5.</h5>
</div>
</div>
<div id="question-3-2" class="section level3">
<h3>Question 3</h3>
<blockquote>
<p>(1)Use EM algorithm to solve MLE of p and q (consider missing data nAA and nBB).(2)Show that the log-maximum likelihood values in M-steps are increasing via line plot.</p>
</blockquote>
</div>
<div id="answer-3-2" class="section level3">
<h3>Answer 3</h3>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1">nA &lt;-<span class="st"> </span><span class="dv">28</span></a>
<a class="sourceLine" id="cb87-2" data-line-number="2">nB &lt;-<span class="st"> </span><span class="dv">24</span></a>
<a class="sourceLine" id="cb87-3" data-line-number="3">nOO &lt;-<span class="st"> </span><span class="dv">41</span></a>
<a class="sourceLine" id="cb87-4" data-line-number="4">nAB &lt;-<span class="st"> </span><span class="dv">70</span></a>
<a class="sourceLine" id="cb87-5" data-line-number="5"></a>
<a class="sourceLine" id="cb87-6" data-line-number="6">theta0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb87-7" data-line-number="7">l &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb87-8" data-line-number="8"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>) {</a>
<a class="sourceLine" id="cb87-9" data-line-number="9">  E &lt;-<span class="st"> </span><span class="cf">function</span>(theta) {</a>
<a class="sourceLine" id="cb87-10" data-line-number="10">    p &lt;-<span class="st"> </span>theta[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb87-11" data-line-number="11">    q &lt;-<span class="st"> </span>theta[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb87-12" data-line-number="12">    r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</a>
<a class="sourceLine" id="cb87-13" data-line-number="13">    p0 &lt;-<span class="st"> </span>theta0[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb87-14" data-line-number="14">    q0 &lt;-<span class="st"> </span>theta0[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb87-15" data-line-number="15">    r0 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p0<span class="op">-</span>q0</a>
<a class="sourceLine" id="cb87-16" data-line-number="16">    <span class="kw">return</span>(<span class="dv">2</span><span class="op">*</span>nA<span class="op">*</span>(<span class="kw">log</span>(p)<span class="op">+</span>r0<span class="op">/</span>(p0<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r0)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>r<span class="op">/</span>p))<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nB<span class="op">*</span>(<span class="kw">log</span>(q)<span class="op">+</span>r0<span class="op">/</span>(q0<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r0)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>r<span class="op">/</span>q))<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">*</span><span class="kw">log</span>(r)<span class="op">+</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q))</a>
<a class="sourceLine" id="cb87-17" data-line-number="17">  }</a>
<a class="sourceLine" id="cb87-18" data-line-number="18">  Obj &lt;-<span class="st"> </span><span class="cf">function</span>(theta) <span class="op">-</span><span class="kw">E</span>(theta)</a>
<a class="sourceLine" id="cb87-19" data-line-number="19">  optim &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>), Obj)</a>
<a class="sourceLine" id="cb87-20" data-line-number="20">  theta0 &lt;-<span class="st"> </span>optim<span class="op">$</span>par</a>
<a class="sourceLine" id="cb87-21" data-line-number="21">  l[j] &lt;-<span class="st"> </span><span class="op">-</span>optim<span class="op">$</span>value</a>
<a class="sourceLine" id="cb87-22" data-line-number="22">}</a>
<a class="sourceLine" id="cb87-23" data-line-number="23"><span class="kw">print</span>(theta0)</a></code></pre></div>
<pre><code>## [1] 0.3273325 0.3104528</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1"><span class="kw">plot</span>(l[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>], <span class="dt">type =</span> <span class="st">'l'</span>, <span class="dt">xlab =</span> <span class="st">'iterations'</span>, <span class="dt">ylab =</span> <span class="st">'log-maximum likelihood values'</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="conclusion-3.1using-em-algorithmi-get-the-mle-of-p-and-q-is-0.3273325-and-0.3104528." class="section level5">
<h5><strong>Conclusion 3.1:</strong>Using EM algorithm,I get the MLE of p and q is 0.3273325 and 0.3104528.</h5>
</div>
<div id="conclusion-3.2from-the-line-plotwe-can-see-the-iteration-is-converging-quickly." class="section level5">
<h5><strong>Conclusion 3.2:</strong>From the line plot,we can see the iteration is converging quickly.</h5>
</div>
</div>
<div id="hw11" class="section level3">
<h3>HW11</h3>
</div>
<div id="question-1-8" class="section level3">
<h3>Question 1</h3>
<blockquote>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list: formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt, mpg ~ I(1 / disp) + wt )</p>
</blockquote>
</div>
<div id="answer-1-8" class="section level3">
<h3>Answer 1</h3>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1">formulas &lt;-<span class="st"> </span><span class="kw">list</span>( mpg <span class="op">~</span><span class="st"> </span>disp, mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp), mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt, mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt )</a>
<a class="sourceLine" id="cb90-2" data-line-number="2">fit1 &lt;-<span class="st"> </span>fit2 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb90-3" data-line-number="3"></a>
<a class="sourceLine" id="cb90-4" data-line-number="4"><span class="co">#for loops</span></a>
<a class="sourceLine" id="cb90-5" data-line-number="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb90-6" data-line-number="6">  fit1[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(formulas[[i]], mtcars)</a>
<a class="sourceLine" id="cb90-7" data-line-number="7">}</a>
<a class="sourceLine" id="cb90-8" data-line-number="8"><span class="kw">print</span>(fit1)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1"><span class="co">#lapply()</span></a>
<a class="sourceLine" id="cb92-2" data-line-number="2">fit2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas, <span class="cf">function</span>(x) <span class="kw">lm</span>(x,mtcars))</a>
<a class="sourceLine" id="cb92-3" data-line-number="3"><span class="kw">print</span>(fit2)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="question-2-8" class="section level3">
<h3>Question 2</h3>
<blockquote>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function? bootstraps &lt;- lapply(1:10, function(i) { rows &lt;- sample(1:nrow(mtcars), rep = TRUE) mtcars[rows, ] })</p>
</blockquote>
</div>
<div id="answer-2-8" class="section level3">
<h3>Answer 2</h3>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb94-2" data-line-number="2">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb94-3" data-line-number="3">rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb94-4" data-line-number="4">mtcars[rows, ]</a>
<a class="sourceLine" id="cb94-5" data-line-number="5">})</a>
<a class="sourceLine" id="cb94-6" data-line-number="6">n &lt;-<span class="st"> </span><span class="kw">length</span>(bootstraps)</a>
<a class="sourceLine" id="cb94-7" data-line-number="7">fit3 &lt;-<span class="st"> </span>fit4 &lt;-<span class="st"> </span>fit5 &lt;-<span class="st"> </span><span class="kw">list</span>(n)</a>
<a class="sourceLine" id="cb94-8" data-line-number="8"></a>
<a class="sourceLine" id="cb94-9" data-line-number="9"><span class="co">#a for loop</span></a>
<a class="sourceLine" id="cb94-10" data-line-number="10"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb94-11" data-line-number="11">  fit3[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp, bootstraps[[i]])</a>
<a class="sourceLine" id="cb94-12" data-line-number="12">}</a>
<a class="sourceLine" id="cb94-13" data-line-number="13"><span class="kw">print</span>(fit3)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     26.4707      -0.0296  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.58356     -0.04291  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.30606     -0.04375  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.34619     -0.04572  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.17123     -0.04688  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.15068     -0.04413  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.70607     -0.04714  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     29.8303      -0.0402  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.28341     -0.03452  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.53057     -0.03053</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1"><span class="co">#lapply()</span></a>
<a class="sourceLine" id="cb96-2" data-line-number="2">fit4 &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="cf">function</span>(x) <span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp, bootstraps[[x]]))</a>
<a class="sourceLine" id="cb96-3" data-line-number="3"><span class="kw">print</span>(fit4)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[x]])
## 
## Coefficients:
## (Intercept)         disp  
##     26.4707      -0.0296  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[x]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.58356     -0.04291  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[x]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.30606     -0.04375  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[x]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.34619     -0.04572  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[x]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.17123     -0.04688  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[x]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.15068     -0.04413  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[x]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.70607     -0.04714  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[x]])
## 
## Coefficients:
## (Intercept)         disp  
##     29.8303      -0.0402  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[x]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.28341     -0.03452  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[x]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.53057     -0.03053</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1"><span class="co">#lapply() without an anonymous function</span></a>
<a class="sourceLine" id="cb98-2" data-line-number="2">fit5 &lt;-<span class="st"> </span><span class="kw">lapply</span>(bootstraps, lm, <span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>disp)</a>
<a class="sourceLine" id="cb98-3" data-line-number="3"><span class="kw">print</span>(fit5)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     26.4707      -0.0296  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.58356     -0.04291  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.30606     -0.04375  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.34619     -0.04572  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.17123     -0.04688  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.15068     -0.04413  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.70607     -0.04714  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     29.8303      -0.0402  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.28341     -0.03452  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.53057     -0.03053</code></pre>
</div>
<div id="question-3-3" class="section level3">
<h3>Question 3</h3>
<blockquote>
<p>For each model in the previous two exercises, extract R2 using the function below. rsq &lt;- function(mod) summary(mod)$r.squared</p>
</blockquote>
</div>
<div id="answer-3-3" class="section level3">
<h3>Answer 3</h3>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb100-2" data-line-number="2">r.squared1 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb100-3" data-line-number="3">r.squared2 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb100-4" data-line-number="4"></a>
<a class="sourceLine" id="cb100-5" data-line-number="5"><span class="co">#Question 1</span></a>
<a class="sourceLine" id="cb100-6" data-line-number="6">r.squared1 &lt;-<span class="st"> </span><span class="kw">lapply</span>(fit1, rsq)</a>
<a class="sourceLine" id="cb100-7" data-line-number="7"><span class="kw">print</span>(r.squared1)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1"><span class="co">#Question 2</span></a>
<a class="sourceLine" id="cb102-2" data-line-number="2">r.squared2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(fit3, rsq)</a>
<a class="sourceLine" id="cb102-3" data-line-number="3"><span class="kw">print</span>(r.squared2)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.5491998
## 
## [[2]]
## [1] 0.6804651
## 
## [[3]]
## [1] 0.6946612
## 
## [[4]]
## [1] 0.7952022
## 
## [[5]]
## [1] 0.8062361
## 
## [[6]]
## [1] 0.8057083
## 
## [[7]]
## [1] 0.8061748
## 
## [[8]]
## [1] 0.6943378
## 
## [[9]]
## [1] 0.6041705
## 
## [[10]]
## [1] 0.6102182</code></pre>
</div>
<div id="question-4-1" class="section level3">
<h3>Question 4</h3>
<blockquote>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial. trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE ) Extra challenge: get rid of the anonymous function by using [[ directly.</p>
</blockquote>
</div>
<div id="answer-4-1" class="section level3">
<h3>Answer 4</h3>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">12</span>)</a>
<a class="sourceLine" id="cb104-2" data-line-number="2">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</a>
<a class="sourceLine" id="cb104-3" data-line-number="3"><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb104-4" data-line-number="4"><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb104-5" data-line-number="5"><span class="dt">simplify =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb104-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb104-7" data-line-number="7"></a>
<a class="sourceLine" id="cb104-8" data-line-number="8"><span class="co">#sapply()</span></a>
<a class="sourceLine" id="cb104-9" data-line-number="9"><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="op">$</span>p.value)</a></code></pre></div>
<pre><code>##   [1] 0.082499937 0.330784795 0.993047864 0.477290348 0.406404458
##   [6] 0.085187996 0.844111822 0.379938241 0.635628066 0.786437709
##  [11] 0.526876535 0.715040454 0.110824795 0.809350882 0.065930332
##  [16] 0.808664441 0.859265752 0.608593210 0.651687787 0.793923636
##  [21] 0.387259211 0.012011087 0.304023541 0.229197439 0.765511648
##  [26] 0.231204886 0.898434865 0.308273827 0.098051642 0.064364010
##  [31] 0.772742843 0.961870044 0.126951686 0.678720694 0.149908710
##  [36] 0.027666868 0.673732195 0.276325272 0.525299726 0.935774019
##  [41] 0.577354583 0.550658883 0.523809077 0.821460941 0.798589758
##  [46] 0.521098617 0.896046097 0.286044180 0.195748512 0.431651130
##  [51] 0.754932607 0.588776309 0.547781320 0.417193253 0.452785842
##  [56] 0.013746851 0.638739685 0.745462528 0.882385322 0.089179648
##  [61] 0.003132675 0.442411777 0.703167263 0.482340507 0.498785819
##  [66] 0.925679134 0.932265499 0.016249868 0.759802613 0.226230558
##  [71] 0.944056294 0.273858627 0.453569026 0.245504470 0.634473466
##  [76] 0.780832008 0.650077794 0.248769279 0.279270617 0.949787094
##  [81] 0.824539608 0.333125010 0.612011717 0.268620544 0.283314643
##  [86] 0.419813050 0.017097642 0.641691213 0.221103687 0.200611697
##  [91] 0.647253469 0.550783330 0.147248867 0.748154631 0.377174096
##  [96] 0.849968120 0.759417068 0.900474893 0.582294493 0.615195429</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1"><span class="co">#&quot;[[&quot;</span></a>
<a class="sourceLine" id="cb106-2" data-line-number="2"><span class="kw">sapply</span>(trials, <span class="st">'[['</span>, <span class="st">'p.value'</span>)</a></code></pre></div>
<pre><code>##   [1] 0.082499937 0.330784795 0.993047864 0.477290348 0.406404458
##   [6] 0.085187996 0.844111822 0.379938241 0.635628066 0.786437709
##  [11] 0.526876535 0.715040454 0.110824795 0.809350882 0.065930332
##  [16] 0.808664441 0.859265752 0.608593210 0.651687787 0.793923636
##  [21] 0.387259211 0.012011087 0.304023541 0.229197439 0.765511648
##  [26] 0.231204886 0.898434865 0.308273827 0.098051642 0.064364010
##  [31] 0.772742843 0.961870044 0.126951686 0.678720694 0.149908710
##  [36] 0.027666868 0.673732195 0.276325272 0.525299726 0.935774019
##  [41] 0.577354583 0.550658883 0.523809077 0.821460941 0.798589758
##  [46] 0.521098617 0.896046097 0.286044180 0.195748512 0.431651130
##  [51] 0.754932607 0.588776309 0.547781320 0.417193253 0.452785842
##  [56] 0.013746851 0.638739685 0.745462528 0.882385322 0.089179648
##  [61] 0.003132675 0.442411777 0.703167263 0.482340507 0.498785819
##  [66] 0.925679134 0.932265499 0.016249868 0.759802613 0.226230558
##  [71] 0.944056294 0.273858627 0.453569026 0.245504470 0.634473466
##  [76] 0.780832008 0.650077794 0.248769279 0.279270617 0.949787094
##  [81] 0.824539608 0.333125010 0.612011717 0.268620544 0.283314643
##  [86] 0.419813050 0.017097642 0.641691213 0.221103687 0.200611697
##  [91] 0.647253469 0.550783330 0.147248867 0.748154631 0.377174096
##  [96] 0.849968120 0.759417068 0.900474893 0.582294493 0.615195429</code></pre>
</div>
<div id="question-5" class="section level3">
<h3>Question 5</h3>
<blockquote>
<p>Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</p>
</blockquote>
</div>
<div id="answer-5" class="section level3">
<h3>Answer 5</h3>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb108-2" data-line-number="2">boot_df &lt;-<span class="st"> </span><span class="cf">function</span>(x) x[<span class="kw">sample</span>(<span class="kw">nrow</span>(x), <span class="dt">rep =</span> T), ]</a>
<a class="sourceLine" id="cb108-3" data-line-number="3">rsquared &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb108-4" data-line-number="4">boot_lm &lt;-<span class="st"> </span><span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb108-5" data-line-number="5">  <span class="kw">rsquared</span>(<span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>disp, <span class="dt">data =</span> <span class="kw">boot_df</span>(mtcars)))</a>
<a class="sourceLine" id="cb108-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb108-7" data-line-number="7"><span class="kw">system.time</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="fl">1e5</span>, boot_lm))</a>
<a class="sourceLine" id="cb108-8" data-line-number="8"><span class="kw">system.time</span>(<span class="kw">unlist</span>(<span class="kw">mclapply</span>(<span class="dv">1</span><span class="op">:</span><span class="fl">1e5</span>, boot_lm, <span class="dt">mc.cores =</span> <span class="dv">4</span>)))</a></code></pre></div>
<div id="conclusionfrom-the-abovewe-can-see-that-mcvapply-cant-run-correctly-on-windows.i-think-its-because-we-cant-run-the-codes-on-different-cores." class="section level5">
<h5><strong>Conclusion:</strong>From the above,we can see that mcvapply() can’t run correctly on Windows.I think it’s because we can’t run the codes on different cores.</h5>
</div>
</div>
<div id="hw12" class="section level3">
<h3>HW12</h3>
</div>
<div id="question-6" class="section level3">
<h3>Question</h3>
<blockquote>
<p>You have already written an R function for Exercise 9.4 (page 277, Statistical Computing with R).(1)Rewrite an Rcpp function for the same task.(2)Compare the generated random numbers by the two functions using qqplot.(3)Campare the computation time of the two functions with microbenchmark.(4)Comments your results.</p>
</blockquote>
</div>
<div id="answer-6" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" data-line-number="1"><span class="co">#the function written before</span></a>
<a class="sourceLine" id="cb109-2" data-line-number="2"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb109-3" data-line-number="3"><span class="kw">library</span>(GeneralizedHyperbolic)</a>
<a class="sourceLine" id="cb109-4" data-line-number="4">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma,x0,N) {</a>
<a class="sourceLine" id="cb109-5" data-line-number="5">x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb109-6" data-line-number="6">x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb109-7" data-line-number="7">u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb109-8" data-line-number="8">k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb109-9" data-line-number="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb109-10" data-line-number="10">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb109-11" data-line-number="11"><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">abs</span>(y))){</a>
<a class="sourceLine" id="cb109-12" data-line-number="12">x[i] &lt;-<span class="st"> </span>y </a>
<a class="sourceLine" id="cb109-13" data-line-number="13">k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>}</a>
<a class="sourceLine" id="cb109-14" data-line-number="14"><span class="cf">else</span> {</a>
<a class="sourceLine" id="cb109-15" data-line-number="15">x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb109-16" data-line-number="16"></a>
<a class="sourceLine" id="cb109-17" data-line-number="17">} }</a>
<a class="sourceLine" id="cb109-18" data-line-number="18"><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb109-19" data-line-number="19">}</a>
<a class="sourceLine" id="cb109-20" data-line-number="20"></a>
<a class="sourceLine" id="cb109-21" data-line-number="21"><span class="co">#the function using Rcpp</span></a>
<a class="sourceLine" id="cb109-22" data-line-number="22"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb109-23" data-line-number="23"><span class="kw">cppFunction</span>(<span class="st">'List rw_Metropolis(double sigma, double x0, int N) {</span></a>
<a class="sourceLine" id="cb109-24" data-line-number="24"><span class="st">NumericVector x(N);</span></a>
<a class="sourceLine" id="cb109-25" data-line-number="25"><span class="st">x[0] = x0;</span></a>
<a class="sourceLine" id="cb109-26" data-line-number="26"><span class="st">int k = 0;</span></a>
<a class="sourceLine" id="cb109-27" data-line-number="27"><span class="st">for (int i = 1;i &lt; N;i++) {</span></a>
<a class="sourceLine" id="cb109-28" data-line-number="28"><span class="st">double u = runif(1)[0];</span></a>
<a class="sourceLine" id="cb109-29" data-line-number="29"><span class="st">double y = rnorm(1, x[i-1], sigma)[0];</span></a>
<a class="sourceLine" id="cb109-30" data-line-number="30"><span class="st">if (u &lt;= exp(abs(x[i-1]) - abs(y))){</span></a>
<a class="sourceLine" id="cb109-31" data-line-number="31"><span class="st">x[i] = y;</span></a>
<a class="sourceLine" id="cb109-32" data-line-number="32"><span class="st">k = k + 1;}</span></a>
<a class="sourceLine" id="cb109-33" data-line-number="33"><span class="st">else </span></a>
<a class="sourceLine" id="cb109-34" data-line-number="34"><span class="st">x[i] = x[i-1];</span></a>
<a class="sourceLine" id="cb109-35" data-line-number="35"><span class="st">}</span></a>
<a class="sourceLine" id="cb109-36" data-line-number="36"><span class="st">List result = List::create(x,k);</span></a>
<a class="sourceLine" id="cb109-37" data-line-number="37"><span class="st">return(result);</span></a>
<a class="sourceLine" id="cb109-38" data-line-number="38"><span class="st">}'</span>)</a>
<a class="sourceLine" id="cb109-39" data-line-number="39"></a>
<a class="sourceLine" id="cb109-40" data-line-number="40"><span class="co">#generate random samples</span></a>
<a class="sourceLine" id="cb109-41" data-line-number="41"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb109-42" data-line-number="42">N &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb109-43" data-line-number="43">sigma &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb109-44" data-line-number="44">x0 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb109-45" data-line-number="45">sample1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma,x0,N)<span class="op">$</span>x</a>
<a class="sourceLine" id="cb109-46" data-line-number="46">sample2 &lt;-<span class="st"> </span><span class="kw">rw_Metropolis</span>(sigma,x0,N)[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb109-47" data-line-number="47"></a>
<a class="sourceLine" id="cb109-48" data-line-number="48"><span class="co">#qq plot</span></a>
<a class="sourceLine" id="cb109-49" data-line-number="49"><span class="kw">library</span>(car)</a>
<a class="sourceLine" id="cb109-50" data-line-number="50"><span class="kw">qqplot</span>(sample1, sample2, <span class="dt">xlab =</span> <span class="st">&quot;the samples using R&quot;</span>,</a>
<a class="sourceLine" id="cb109-51" data-line-number="51">       <span class="dt">ylab =</span> <span class="st">&quot;the samples using Rcpp&quot;</span>)</a>
<a class="sourceLine" id="cb109-52" data-line-number="52">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb109-53" data-line-number="53"><span class="kw">lines</span>(x,x,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1"><span class="co">#Campare the computation time</span></a>
<a class="sourceLine" id="cb110-2" data-line-number="2"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb110-3" data-line-number="3">ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rw1 =</span> <span class="kw">rw.Metropolis</span>(sigma,x0,N),<span class="dt">rw2 =</span> <span class="kw">rw_Metropolis</span>(sigma,x0,N))</a>
<a class="sourceLine" id="cb110-4" data-line-number="4"><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##   expr        lq    median       uq
## 1  rw1 2604.1225 2776.2485 2995.414
## 2  rw2  193.0805  203.3445  214.249</code></pre>
<div id="conclusion-we-can-see-that-the-qq-plot-is-close-to-y-xwhich-means-the-samples-generated-by-two-samplers-are-quite-similar.by-computing-the-computation-timethe-time-of-sampler-using-r-is-much-more-than-that-of-sampler-using-rcppso-rcpp-gives-higher-performance-computation." class="section level5">
<h5><strong>Conclusion :</strong>We can see that the qq plot is close to y = x,which means the samples generated by two samplers are quite similar.By computing the computation time,the time of sampler using R is much more than that of sampler using Rcpp,so Rcpp gives higher performance computation.</h5>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
